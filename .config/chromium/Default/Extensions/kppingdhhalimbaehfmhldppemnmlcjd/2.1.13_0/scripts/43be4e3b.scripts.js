!function(){"use strict";String.prototype.hashCode=function(){var a,b,c=0,d=this.length;for(b=0;d>b;b+=1)a=this.charCodeAt(b),c=31*c+a,c|=0;return c},String.fromCodePoint=String.fromCodePoint||function(){for(var a,b=arguments.length,c=[];b--;){if(a=arguments[b],0>a||a>1114111)throw new RangeError;65536>a?c.unshift(a):(a-=65536,c.unshift(55296|a>>10,56320|1023&a))}return String.fromCharCode.apply(String,c)},String.prototype.codePointAt=String.prototype.codePointAt||function(a){var b=this.toString(),c=b.length,d=b.charCodeAt(a),e=b.charCodeAt(a+1);return 0>a||a>=c?0/0:55296>d||d>56319||a+1===c?d:56320>e||d>57343?d:65536+1024*(d-55296)+e-56320},ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(a,b){var c,d,e,f=new Uint8Array(this);for("undefined"==typeof b&&(b=f.length),e=new Uint8Array(b-a),d=e.length,c=0;d>c;c+=1)e[c]=f[c+a];return e.buffer}),ArrayBuffer.prototype.toString=function(a){if(a){var b,c=new Uint8Array(this),d=this.byteLength,e="";for(b=0;d>b;b+=1)e+=String.fromCharCode(c[b]);return btoa(e)}return"[object ArrayBuffer]"}}(),angular.module("scriptLoader",[]).factory("scriptLoader",["$q",function(a){var b=[],c=function(c,d){function e(){h.resolve(),d&&d()}var f,g,h=a.defer();return b.indexOf(c)<0?(b.push(c),f=document.getElementsByTagName("script")[0],g=document.createElement("script"),g.src=c,g.addEventListener?g.addEventListener("load",function(){e()},!1):g.onreadystatechange=function(){g.readyState in{loaded:1,complete:1}&&(g.onreadystatechange=null,e())},f.parentNode.insertBefore(g,f)):e(),h.promise};return{load:c}}]),angular.module("storage",["scriptLoader"]).factory("storage",["scriptLoader",function(a){var b={};if(window.indexedDB){var c=function(){},d={},e=[],f="storage",g="storeKey",h=!1;a.load("bower_components/idbwrapper/idbstore.min.js",function(){d=new IDBStore({dbVersion:1,storeName:f||"storage",keyPath:g,onStoreReady:function(){h=!0;var a;for(a=0;a<e.length;a+=1)e[a]()}})}),b.save=function(a,b,f,g){var i=function(){d.put({storeKey:a,obj:b},f||c,g||c)};h?i():e.push(i)},b.load=function(a,b,f){if((a||!isNaN(a))&&"function"==typeof b){var g=function(){d.get(a,function(a){b(a&&a.obj)},f||c)};h?g():e.push(g)}},b.clear=function(a,b){d.clear(a,b||c)}}else b.save=function(a,b,c){setTimeout(function(){localStorage.setItem(a,JSON.stringify(b)),c&&c()},0)},b.load=function(a,b){!a&&isNaN(a)||"function"!=typeof b||setTimeout(function(){b(JSON.parse(localStorage.getItem(a)))},0)},b.clear=function(a){setTimeout(function(){localStorage.clear(),a&&a()},0)};return b}]),function(){"use strict";var a={};angular.module("tmpl",[]).factory("template",["$http","$q",function(b,c){var d=function(a,b,c){var d,e,f,g,h,i,j,k,l=[],m=b.length,n=c.length,o={};for(i=new Array(m+1).join(" "),d=new Array(n+1).join(" ");a.length;){e=a.indexOf(b),k=e+m,j=a.slice(k),f=0;do f=j.indexOf(c),g=j.indexOf(b),-1!==g&&(j=j.slice(0,g)+i+j.slice(g+m)),j=j.slice(0,f)+d+j.slice(f+n);while(-1!==g&&f>g);if(f+=k,!(f>e&&-1!==e)){l.push(a);break}k=a.slice(0,e),k&&l.push(k),k=a.slice(e+m,f),k&&(l.push(""),o[k]||(o[k]=[]),o[k].push(l.length-1)),a=a.slice(f+n)}for(h in o)k=h.indexOf(b),o.hasOwnProperty(h)&&-1!==k&&(e=h.search(/\s/),-1!==e&&(k=Math.min(k,e)),k=h.slice(0,k),o[k]={str:h.slice(k.length).replace(/^\n/,""),opening:b,closing:c,idxArray:o[h]},delete o[h]);return{stringArray:l,map:o}};return function e(f){var g,h="}}",i="{{",j="tmpl/",k={};return k.config=function(a){return"string"==typeof a.opening&&a.opening.length>0&&(i=a.opening),"string"==typeof a.closing&&a.closing.length>0&&(h=a.closing),"string"==typeof a.tmplDir&&(j=a.tmplDir),this},k.set=function(a){return g=d(a,i,h),this},k.get=function(d){var e=c.defer(),f=d.replace(/\.tmpl$/,"");return a.hasOwnProperty(f)?e.resolve(a[f]):b.get(j+f+".tmpl",{transformResponse:!1}).then(function(b){a[f]=k.set(b.data),e.resolve(a[f])}),e.promise},k.fill=function(a){var b,c,d,f,h,i,j,k=g.map,l=g.stringArray;for(f in a)if(k.hasOwnProperty(f)){if(k[f].fill||k[f].str){if(k[f].str&&(b=k[f].idxArray,k[f]=e(k[f].str,k[f].opening,k[f].closing),k[f].idxArray=b),i=a[f].length,j="",a[f]){for(d=0;i>d;d+=1)j+=k[f].fill(a[f][d]);i||(j=k[f].fill(a[f]))}b=k[f].idxArray}else j=a[f],b=k[f];for(c=0,h=b.length;h>c;c+=1)l[b[c]]=j}return l.join("")},f&&k.set(f),k}}])}(),angular.element.prototype.is||(angular.element.prototype.is=function(a){var b,c=a.split(/[,\s]+/);for(b=0;b<c.length;b+=1)if(c[b].toUpperCase()===this[0].tagName.toUpperCase())return!0;return!1}),angular.element2||(angular.element2=function(a){"string"==typeof a&&(a=a.trim()),a=angular.element(a);var b;for(b=0;b<a.length;b+=1)if(1===a[b].nodeType)return angular.element(a[b]);return a}),angular.module("svg",["tmpl"]).factory("svgPath",function(){function a(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}}function b(a,b){return{x:2*b.x-a.x,y:2*b.y-a.y}}function c(a,b){var c,d,e,f,g,h,i,j,k;if(b){if(c=b.a||1,d=b.b||0,e=b.c||0,f=b.d||1,g=b.e||0,h=b.f||0,j=a.length,!j)return{x:c*a.x+e*a.y+g,y:d*a.x+f*a.y+h};if(a[0]&&!isNaN(a[0].x)&&!isNaN(a[0].y)){for(k=[],i=0;j>i;i+=1)k[i]={},k[i].x=c*a[i].x+e*a[i].y+g,k[i].y=d*a[i].x+f*a[i].y+h;return k}if("number"==typeof a[0]&&0===j%2)for(i=0;j>i;i+=2)k={x:a[i],y:a[i+1]},a[i]=c*k.x+e*k.y+g,a[i+1]=d*k.x+f*k.y+h}}function d(a){return Math.sqrt(a.x*a.x+a.y*a.y)}function e(a,b){return d({x:b.x-a.x,y:b.y-a.y})}function f(a,b){var c,e=a.x*b.y-a.y*b.x>0?1:-1;return c=(a.x*b.x+a.y*b.y)/(d(a)*d(b)),c>1?c=1:-1>c&&(c=-1),180*e*Math.acos(c)/Math.PI}function g(a,b){return(isNaN(b)||0>b)&&(b=3),a.toFixed(b).replace(/\.0+$/,"").replace(/(\.[^0]+)0+$/,"$1")}function h(a){return a=a.toLowerCase(),/[vh]/.test(a)?1:/[mlt]/.test(a)?2:/[sq]/.test(a)?4:/[c]/.test(a)?6:/[a]/.test(a)?7:0}function i(a){var b,c,d,e,f,g,h,i=[];for(a=a.replace(/,/g," ").replace(/-/g," -").replace(/-\s+/g,"-").replace(/e\s*/gi,"e").replace(/\.(\d+)\./g,".$1 .").replace(/\.(\d+)\./g,".$1 .").replace(/\s+/g," "),i=a.replace(/([mzlhvcsqta])\s?/gi,"|$1").split("|"),i.splice(0,1),f=i.length,d=0;f>d;d+=1){if(h=i[d],c=h[0],b=h.substr(1).trim())for(b=b.split(/\s/),g=b.length,e=0;g>e;e+=1)b[e]=Number(b[e]);else b=[];i[d]={cmd:c,args:b}}return i}function j(a){var b=[],c=0,d=a.length;for(c;d>c;c+=1)b.push(a[c].x),b.push(a[c].y);return b}function k(a){var b,c,d=[];if(a){if("string"==typeof a)for(a=a.trim().split(/[\s,]+/),c=a.length,b=0;c>b;b+=1)a[b]=Number(a[b]);if(c=a.length,0!==c%2&&(a.push(0),c+=1),!(6>c))return d.push({cmd:"M",args:[a[0],a[1]]}),d.push({cmd:"L",args:a.slice(2)}),d.push({cmd:"Z"}),d}}function l(a,b,d,e,f,g){function h(a){v.push({cmd:"L",args:a})}function i(a){var b=[{x:q,y:s},{x:o,y:s},{x:o,y:r},{x:q,y:r}];u[a]&&(u[a].points=c(u[a].points,{e:b[a].x,f:b[a].y}),v.push({cmd:"C",args:j(u[a].points.slice(1))}))}var k,l,m,n,o,q,r,s,t,u=[],v=[];return a=Number(a),b=Number(b),f=Math.abs(Number(f)),g=Math.abs(Number(g)),d=Math.abs(Number(d)),e=Math.abs(Number(e)),0!==d&&0!==e?(!g&&f?f=g:!f&&g?g=f:f||g||(f=g=0),t=d/2,f/2>t&&(f=t),t=e/2,g/2>t&&(g=t),m=d-2*f,n=e-2*g,f&&(k=a+d/2,l=b+e/2,u=p({cx:0,cy:0,rx:f,ry:g})),o=a+f,q=o+m,r=b+g,s=r+n,v.push({cmd:"M",args:[o,b]}),m&&h([q,b]),i(3),n&&h([q+f,s]),i(0),m&&h([o,s+g]),i(1),n&&h([o-f,r]),i(2),v.push({cmd:"Z"}),v):void 0}function m(a,b,c,d){var e,f,g,h=[];if(a=Number(a),b=Number(b),c=Number(c),d=Number(d),0!==c||0!==d){for(e=p({cx:a,cy:b,rx:c,ry:d}),h.push({cmd:"M",args:[a+c,b]}),g=e.length,f=0;g>f;f+=1)h.push({cmd:"C",args:j(e[f].points.slice(1))});return h.push({cmd:"Z"}),h}}function n(a){var b,c,d=!1,e=a.tagName.toUpperCase();return a.getAttribute||(d=!0,a.getAttribute=function(b){return a[b]}),"PATH"===e?b=i(a.getAttribute("d")):"POLYGON"===e?b=k(a.getAttribute("points")):"RECT"===e?b=l(a.getAttribute("x"),a.getAttribute("y"),a.getAttribute("width"),a.getAttribute("height"),a.getAttribute("rx"),a.getAttribute("ry")):"ELLIPSE"===e?b=m(a.getAttribute("cx"),a.getAttribute("cy"),a.getAttribute("rx"),a.getAttribute("ry")):"CIRCLE"===e&&(c=a.getAttribute("r"),b=m(a.getAttribute("cx"),a.getAttribute("cy"),c,c)),d&&delete a.getAttribute,b}function o(a){var b,c,d,e,f,g,j,k=[];for(f="string"==typeof a?i(a):n(a),j=f?f.length:0,e=0;j>e;e+=1)if(c=f[e].args,d=f[e].cmd,!/m/.test(d)||!f[e+1]||!/m/.test(f[e+1].cmd))if(b=h(d),c=c||[],c.length>b){g=0;do k.push({cmd:d,args:c.slice(g,g+b)}),g+=b,"m"===d?d="l":"M"===d&&(d="L");while(g<c.length)}else k.push({cmd:d,args:c});return r(k)}function p(a){function b(a,b){var c=(b-90*a)/90;return p?c:1-c}var c,d,e,f,g,h,i,j,k,l=a.cx,m=a.cy,n=a.rx,o=a.ry,p=a.angleDiff&&a.angleDiff>0,q=a.startAngle?a.startAngle%360:0,r=a.angleDiff?(a.angleDiff+q)%360:360,s=4*(Math.sqrt(2)-1)/3,t=s*n,u=s*o,v=[],w=[],x={x:l,y:m-o},y={x:l+n,y:m},z={x:l,y:m+o},B={x:l-n,y:m};if(e=x.x-t,f=x.x+t,g=B.y-u,h=B.y+u,v.push([{x:x.x,y:x.y},{x:f,y:x.y},{x:y.x,y:g},{x:y.x,y:y.y}]),v.push([{x:B.x,y:B.y},{x:B.x,y:g},{x:e,y:x.y},{x:x.x,y:x.y}]),v.push([{x:z.x,y:z.y},{x:e,y:z.y},{x:B.x,y:h},{x:B.x,y:B.y}]),v.push([{x:y.x,y:y.y},{x:y.x,y:h},{x:f,y:z.y},{x:z.x,y:z.y}]),0>r&&(r+=360),p){for(c=Math.floor(q/90),c>3&&(c=0),d=Math.ceil(r/90)-1,0>d&&(d=3),k=v.length,j=0;k>j;j+=1)v[j].reverse();for(j=c;j!==d;)w.push(v[j]),j+=1,j>3&&(j=0);w.push(v[j])}else{for(c=Math.ceil(q/90)-1,0>c&&(c=3),d=Math.floor(r/90),d>3&&(d=0),j=c;j!==d;)w.push(v[j]),j-=1,0>j&&(j=3);w.push(v[j])}for(0!==q%90&&(i=A(w[0]),w[0]=i.splitAt(b(c,q))[1].points),0!==r%90&&(j=w.length-1,i=A(w[j]),w[j]=i.splitAt(b(d,r))[0].points),k=w.length,j=0;k>j;j+=1)w[j]=A(w[j]);return w}function q(a,b){function d(a){return c(a,{a:F,b:G,c:-G,d:F})}var e,g,h,i,j,k,l,m,n,o,q,r,s,t=a.x,u=a.y,v=b[5],w=b[6],x=b[3],y=b[4],z=Math.abs(b[0]),A=Math.abs(b[1]),B=z*z,C=A*A,D=b[2]%360*Math.PI/180,E={},F=Math.cos(D),G=Math.sin(D);if(t!==v||u!==w){if(!z||!A)return E.cmd="L",E.args=[v,w],E;for(x=x?1:0,y=y?1:0,h=c({x:(t-v)/2,y:(u-w)/2},{a:F,b:-G,c:G,d:F}),k=h.x*h.x,l=h.y*h.y,g=k/B+l/C,g>1&&(g=Math.sqrt(g),z*=g,A*=g,B=z*z,C=A*A),j=(x===y?-1:1)*Math.sqrt(Math.abs((B*C-B*l-C*k)/(B*l+C*k))),j={x:j*(z*h.y/A),y:j*(-A*h.x/z)},i=d(j),i.x+=(t+v)/2,i.y+=(u+w)/2,g={x:(h.x-j.x)/z,y:(h.y-j.y)/A},m=-f({x:1,y:0},g),0>m&&(m+=360),n=f(g,{x:-(h.x+j.x)/z,y:-(h.y+j.y)/A})%360,y&&n>0?n-=360:!y&&0>n&&(n+=360),e=p({cx:i.x,cy:i.y,rx:z,ry:A,startAngle:m,angleDiff:n}),b=[],r=e.length,o=0;r>o;o+=1)for(g=e[o],s=g.points.length,b[o]=[],q=0;s>q;q+=1)D&&(g.points[q]=c(g.points[q],{e:-i.x,f:-i.y}),g.points[q]=d(g.points[q]),g.points[q]=c(g.points[q],{e:i.x,f:i.y})),q>0&&(b[o].push(g.points[q].x),b[o].push(g.points[q].y));return b}}function r(a){function b(a,b){var c,d,f,g,h,i,j,k,l=[],m=0/0;if(b=b||.001,h=a.length,3>h)return!1;for(f=0;h>f;f+=1)g=a[f],c=g.cmd,"Z"===c?(i=!1,j=!1):"M"===c?(i={x:g.args[0],y:g.args[1]},j=!1):"C"===c?(i={x:g.args[4],y:g.args[5]},j=!1):"S"===c||"Q"===c?(i={x:g.args[2],y:g.args[3]},j=!1):"T"===c?(i={x:g.args[0],y:g.args[1]},j=!1):"L"===c&&(d={x:g.args[0],y:g.args[1]},i?(k=(d.y-i.y)/(d.x-i.x),!isNaN(m)&&(k===m||Math.abs(k-m)<b||e(i,d)<b)?l.pop():j?(i=j,m=(d.y-j.y)/(d.x-j.x)):isNaN(k)||(m=k)):i=d,j=d),"L"!==c&&(m=0/0),l.push(g);return l[0].cmd="M",l}var c,d,f,g,h,i,j,k,l,m={x:0,y:0},n=[];for(g=0,j=a.length;j>g;g+=1){if(d=a[g].cmd,h=/[a-z]/.test(d),d=d.toUpperCase(),c=a[g].args,"Z"===d)m=f,f=!1;else if(f||"M"===d||(f=m),"A"===d)h&&(c[5]+=m.x,c[6]+=m.y),l={x:c[5],y:c[6]},c=q(m,c),m=l,d="C";else if("H"===d)h&&(c[0]+=m.x),m={x:c[0],y:m.y},c[1]=m.y,d="L";else if("V"===d)h&&(c[0]+=m.y),m={x:m.x,y:c[0]},c[0]=m.x,c[1]=m.y,d="L";else for(k=c.length,i=0;k>i;i+=2)h&&(c[i]+=m.x,c[i+1]+=m.y),0===(i+2)%k&&(m={x:c[i],y:c[i+1]});if(c&&("M"!==d||!a[g+1]||"M"!==a[g+1].cmd.toUpperCase())){if(c[0]&&c[0].length)for(k=c.length,i=0;k>i;i+=1)n.push({cmd:d,args:c[i]});else n.push({cmd:d,args:c});"M"===d&&(f=m)}}return b(n)}function s(b,c,d,e){var f,g,h,i,j,k,l,m=function(a,b){return{x:(a.x+b.x)/2,y:(a.y+b.y)/2}},n=a(b,c,.75),o=a(e,d,.75),p=(e.x-b.x)/16,q=(e.y-b.y)/16;return f=a(b,c,3/8),g=a(n,o,3/8),g.x-=p,g.y-=q,h=a(o,n,3/8),h.x+=p,h.y+=q,i=a(e,d,3/8),j=m(f,g),k=m(n,o),l=m(h,i),f.offCurve=!0,g.offCurve=!0,h.offCurve=!0,i.offCurve=!0,[f,g,h,i,e]}function t(a){function c(){p.length>2&&o.push(p),p=[]}var d,e,f,g,h,i,j,k,l,m,n={x:0,y:0},o=[],p=[],q=a.length;for(f=0;q>f;f+=1)e=a[f].cmd.toUpperCase(),d=a[f].args,g="M"===e,g||"L"===e?(g&&c(),p.push({x:d[0],y:d[1]}),n={x:d[0],y:d[1]}):"Z"===e?(n={x:0,y:0},c()):h=n,"C"===e?(i={x:d[0],y:d[1]},j={x:d[2],y:d[3]},k={x:d[4],y:d[5]},p=p.concat(s(h,i,j,k)),l=j,n=k):"S"===e?(i=l?b(l,h):h,j={x:d[0],y:d[1]},k={x:d[2],y:d[3]},p=p.concat(s(h,i,j,k)),l=j,n=k):l=!1,"Q"===e?(i={x:d[0],y:d[1],offCurve:!0},j={x:d[2],y:d[3]},p.push(i),p.push(j),m=i,n=j):"T"===e?(m?(i=b(m,h),i.offCurve=!0):i=h,j={x:d[0],y:d[1]},p.push(i),p.push(j),m=i,n=j):m=!1;return p.length>2&&o.push(p),o}function u(a){var c,d,e,f,h,i,j,k,l,m,n,o,p=[],q={x:0,y:0},r={},s=[];for(k=a.length,h=0;k>h;h+=1){if(j=a[h],d=j.args.slice(0),f=j.cmd.toLowerCase(),l=d?d.length:0,l>1){if(r.x=d[l-2],r.y=d[l-1],"c"===f?(m?(o=b(m,q),o.x===d[0]&&o.y===d[1]&&(f="s",d=d.slice(2)),m=o):m={x:d[2],y:d[3]},n=!1):"q"===f?(n?(o=b(n,q),o.x===d[0]&&o.y===d[1]&&(f="t",d=d.slice(2)),n=o):n={x:d[0],y:d[1]},m=!1):"s"===f?(m=m?b(m,q):!1,n=!1):"t"===f?(n=n?b(n,q):!1,m=!1):(m=!1,n=!1),"m"===f)f="M";else for(l=d.length,i=0;l>i;i+=2)d[i]-=q.x,d[i+1]-=q.y;"l"===f&&(0===d[0]?(f="v",d=[d[1]]):0===d[1]&&(f="h",d=[d[0]])),q.x=r.x,q.y=r.y}p.push({cmd:f,args:d})}for(e=[],h=0;k>h;h+=1){for(j=p[h],e.push(j),f=j.cmd,i=h+1;k>i&&p[i].cmd===f;)j.args=j.args.concat(p[i].args),i+=1;h=i-1}for(k=e.length,h=0;k>h;h+=1)for(j=e[h],s.push(j.cmd),l=j.args?j.args.length:0,i=0;l>i;i+=1)c=j.args[i],c=c>=0&&0!==i?" "+g(c):g(c),s.push(c);return s.join("")}function v(a){var b,c,d,e,f,g={},h={};try{if(f=a[0].width.baseVal.value,c=a[0].height.baseVal.value,e=a[0].getAttribute("viewBox"),!e)return{viewBox:{x:0,y:0,width:f,height:c},transform:!1};if(e=e.trim().split(/\s*[\,\s]\s*/),g.x=Number(e[0]),g.y=Number(e[1]),g.w=Number(e[2]),g.h=Number(e[3]),g.w<0||g.h<0)throw new Error("Invalid viewBox.");return f>=c&&g.w>=g.h||c>=f&&g.w>=g.h?(h.a=h.d=f/g.w,h.e=0):(c>=f&&g.w<=g.h||f>=c&&g.w<=g.h)&&(h.d=h.a=c/g.h),h.a&&(h.f=(c-h.d*g.h)/2,h.e=(f-h.a*g.w)/2,h.e-=g.x,h.f-=g.y),!isNaN(h)&&1!==h.a||h.e||h.f||(h=!1),{viewBox:{x:0,y:0,width:f,height:c},transform:h}}catch(i){try{return b=a[0].getBBox(),f=b.width,c=b.height,d=Math.max(f,c),{viewBox:{x:0,y:0,width:d,height:d},transform:!1}}catch(j){return{transform:!1}}}}function w(a){function b(a){var b,c,d=a.attr("transform"),e=/(\w+)\s*\(([e\d\s\.\,\-]+)\)/gm,f=[],g=[];return d?(d.replace(e,function(a,d,e){var h,i;g=e.replace(/-/g," -").replace(/e\s*/g,"e").replace(/,/g," ").replace(/\s+/g," ").trim().split(/\s/),g.forEach(function(a,b){g[b]=Number(a)}),"matrix"===d&&6===g.length?f.push({a:g[0],b:g[1],c:g[2],d:g[3],e:g[4],f:g[5]}):"scale"===d?(h=g[0]||1,i=g[1]||h,f.push({a:h,b:0,c:0,d:i})):"translate"===d?(h=g[0]||0,i=g[1]||0,f.push({a:1,b:0,c:0,d:1,e:h,f:i})):"rotate"===d&&(h=g[0]/180*Math.PI,b=Math.cos(h),c=Math.sin(h),f.push({a:b,b:c,c:-c,d:b}))}),f.reverse()):[]}function c(a,b){var c,d;for(c=0,d=b.length;d>c;c+=1)a.transform(b[c])}function d(a,e,f){var g,h,i,j,k,l,m,n,o,p;if("0"!==a.css("opacity")&&0!==a.attr("opacity")&&(h=a.attr("display"),i=a.css("display"),j=a.attr("fill"),k=a.css("fill"),n=a.attr("visibility"),o=a.css("visibility"),f=f||{},f=JSON.parse(JSON.stringify(f)),(j||k)&&(k=k||j,f.fill="none"===k||"transparent"===k||/rgba\(\d+,\s*\d+,\s*\d+,\s*0\)/.test(k)),"none"!==h&&"none"!==i)){if((n||o)&&(o=o||n,f.visibility="hidden"===o),a.is("g")||a.is("switch"))for(g=a.children(),p=x(),l=0,m=g.length;m>l;l+=1)d(y(g[l]),p,f);else{if(!a.is("polygon, path, circle, rect, ellipse"))return;for(p in f)if(f.hasOwnProperty(p)&&f[p])return;p=x(a[0])}c(p,b(a)),e.append(p)}}var e,f,g,h,i=x();for("string"==typeof a&&(a=y(a)),e=a.children(),f=0,g=e.length;g>f;f+=1)d(y(e[f]),i);return h=v(a),i.transform(h.transform),h.viewBox&&(i.viewBox=h.viewBox),i}function x(a){var b=[],d={};return d.append=function(a){var c,e,f=!1;if(!a)return this;if(z(a)){for(e=a.length,c=0;e>c;c+=1)d.append(a[c]);return this}return"string"!=typeof a&&a.length&&(a=a[0]),"string"==typeof a&&/<\/svg>/i.test(a)||a.tagName&&"svg"===a.tagName.toLowerCase()?(a=w(y(a)),a.viewBox&&(d.viewBox=a.viewBox),a=a.getPathArray(),f=!0):a.tagName||"string"==typeof a?a=o(a):a.getPathArray?(a=a.getPathArray(),f=!0):a=!1,a&&(f?b=b.concat(a):b.push(a)),this},d.setPath=function(a){return b=[],d.append(a)},d.getPathData=function(a){var c,d=[];for(c=0;c<b.length;c+=1)d.push(u(b[c]));return a?d:d.join("")},d.transform=function(a,e){var f,g,h=0,i=b.length;for(!isNaN(e)&&e>=0&&i>e&&(h=e,i=e+1),h;i>h;h+=1)for(f=b[h],g=0;g<f.length;g+=1)c(f[g].args,a);return d.viewBox&&(a.a&&(d.viewBox.width=Math.abs(Math.round(a.a*d.viewBox.width))),a.d&&(d.viewBox.height=Math.abs(Math.round(a.d*d.viewBox.height)))),this},d.scale=function(a,b,c){return a=Number(a),b=Number(b),a?(d.transform({a:a,d:b||a},c),this):this},d.translate=function(a,b,c){return a=Number(a),b=Number(b),isNaN(a)?this:(isNaN(b)&&(b=a),d.transform({e:a,f:b},c),this)},d.rotate=function(a,b){var c,e;return a=Number(a)/180*Math.PI,isNaN(a)?this:(c=Math.cos(a),e=Math.sin(a),d.transform({a:c,b:e,c:-e,d:c},b),this)},d.getTTFContours=function(){var a,c=[];for(a=0;a<b.length;a+=1)c=c.concat(t(b[a]));return c},d.getPathArray=function(){return b.slice(0)},d.setPath(a),d}var y=angular.element2,z=function(a){return"[object Array]"===Object.prototype.toString.call(a)},A=function(b,c,d,e){var f={},g=function(b,c){var d,e,g,h,i,j,k=f.points[0],l=f.points[1],m=f.points[2],n=f.points[3];return d=a(k,l,b),e=a(l,m,b),g=a(m,n,b),h=a(d,e,b),i=a(e,g,b),j=a(h,i,b),c&&c.point?j:[A(k,d,h,j),A(j,i,g,n)]};return b.length?f.points=b.slice(0):(f.points=[],f.points[0]=b,f.points[1]=c,f.points[2]=d,f.points[3]=e),f.getPointAt=function(a){return g(a,{point:!0})},f.splitAt=g,f};return x}).factory("glyphs",["svgPath","template",function(a,b){var c=angular.element2;return function(d){function e(b,d,e){var f,g,h,i,j=parseInt(b.attr("horiz-adv-x"),10);return d=d||0,e||p.fill({width:j||o.defaultAdvX}),f=b.attr("d"),!f||f.length<10||b.hasClass("hidden")?!1:(h=a(f),h.transform({a:1,d:-1,f:o.ascent-d}),e?(h.viewBox={x:0,y:0,width:j,height:o.unitsPerEm},i=b.attr("data-tags")||b.attr("glyph-name"),i&&(i=i.replace(/,[,\s]+/g,",").replace(/,$/,"").replace(/^,/,"").trim(),h.tags=i.split(",")),g=b.attr("unicode"),g&&(h.defaultCode=g.codePointAt(0)),h):c(p.fill({d:h.getPathData()})))}var f,g,h,i,j,k,l,m,n=[],o={},p=b(['<svg viewBox="0 0 {{width}} {{height}}" width="{{width}}" height="{{height}}">','<path d="{{d}}" />',"</svg>"].join(""));if("string"==typeof d&&(d=c(d)),h=d.find("glyph"),j=h.length){for(o.defaultAdvX=parseInt(d.find("font").attr("horiz-adv-x"),10),m=d.find("font-face"),o.ascent=parseInt(m.attr("ascent"),10),o.descent=parseInt(m.attr("descent"),10),o.unitsPerEm=o.ascent-o.descent,p.fill({height:o.unitsPerEm}),k=d.find("metadata"),k.length&&(k=k.find("json"),k.length&&(k=JSON.parse(k.text()),n.metadata={name:k.name||k.fontFamily,url:k.url||k.fontURL,designer:k.designer,designerURL:k.designerURL,license:k.license,licenseURL:k.licenseURL},k.grid&&(n.metadata.grid=k.grid))),g=angular.element(document.body),i=0;20>i;i+=1)if(m=e(c(h[i])),m&&(g.append(m),f=m[0].getBBox(),m.remove(),f.height===o.unitsPerEm)){if(l===f.y)break;l=f.y}for(i=0;j>i;i+=1)m=e(c(h[i]),l,!0),m&&n.push(m)}else n.push(a(d));return n}}]),function(){var a=angular.module("svg"),b={};angular.forEach(["d","width","height","viewBox","x1","x2","y1","y2"],function(a){var c="mi"+a.substr(0,1).toUpperCase()+a.substr(1);b[c]=function(){return{priority:99,link:function(b,d,e){e.$observe(c,function(b){b&&d.attr(a,b)})}}}}),a.directive(b)}(),angular.module("font",["svg","tmpl"]).factory("font",["svgPath","template",function(a,b){function c(a){var b,c,l,n,p,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z=h,$={},_=[],ab=[],bb=0,cb=[0],db=[{aw:0,lsb:0}],eb=0,fb=!0,gb={},hb={},ib=0,jb=0,kb=0,lb=[],mb={},nb=["OS/2","cmap","gasp","glyf","head","hhea","hmtx","loca","maxp","name","post"];for(Q=d.length,p=0;Q>p;p+=1)for(W=d[p].code,isNaN(W)&&(W=p+57344,d[p].code=W),_.push(W),W=d[p].ligatures,K=K||{},M=W?W.length||0:0,!L&&W&&(L=!0),I=0;M>I;I+=1)"string"==typeof W[I]&&W[I].length>1&&(K[W[I]]=d[p].code);for(U in K)if(K.hasOwnProperty(U))for(p=0;p<U.length;p+=1)W=U.charCodeAt(p),_.indexOf(W)<0&&(d.push({code:W,advX:0}),_.push(W));d.sort(function(a,b){return a.code-b.code}),_.sort(function(a,b){return a-b});for(U in K)if(K.hasOwnProperty(U))for(K[U]=_.indexOf(K[U])+1,p=0;p<U.length;p+=1)hb[U.charAt(p)]=_.indexOf(U.charCodeAt(p))+1;for(Q=d.length,p=0;Q>p;p+=1)d[p].contours||(T=d[p].svgPath,T?(T.viewBox&&T.viewBox.height!==g&&(W=g/T.viewBox.height,T.scale(W)),d[p].d=T.transform({a:1,d:-1,f:e}).getPathData(),d[p].contours=T.getTTFContours()):d[p].contours=[[{x:0,y:0},{x:0,y:0},{x:0,y:0}]]),W=s(d[p].contours),ib=k(ib,W.pointsCount),jb=k(jb,W.contourCount),ab.push(W.buffer),!eb&&bb/2>65535&&(eb=1),cb.push(bb/2),bb+=W.buffer.byteLength,W=W.bbox,$.xMin=j($.xMin,W.xMin),$.yMin=j($.yMin,W.yMin),$.xMax=k($.xMax,W.xMax),$.yMax=k($.yMax,W.yMax),N=W.xMin,O=j(N,O),b=d[p].advX,isNaN(b)&&d[p].svgPath&&(b=d[p].svgPath.viewBox,b&&(b=b.width,d[p].advX=b)),isNaN(b)||b===h?b=h:(fb&&Q>1&&(fb=!1),Z=k(b,Z)),Y=k(Y,N+W.xMax-W.xMin),W=b-W.xMax,P=j(P,W),db.push({aw:b,lsb:N});for(Q+=1,cb.push(bb/2),mb.glyf=m(ab),mb.cmap=t(_),mb.gasp=D([65535,15]),mb.head=w({xMin:$.xMin,yMin:$.yMin,xMax:$.xMax,yMax:$.yMax,unitsPerEm:g,indexToLocFormat:eb}),mb.hhea=y({ascent:e,descent:f,advanceWidthMax:Z,numOfLongHorMetrics:db.length,minRightSideBearing:P,minLeftSideBearing:O,xMaxExtent:Y}),mb.hmtx=z(db),mb.loca=B(cb,eb),mb.maxp=u({numGlyphs:Q,maxPoints:ib,maxContours:jb}),mb.name=x(i),L&&(nb=["GSUB"].concat(nb),mb.GSUB=E(K,hb)),l=_[0],l=l>65535?65535:l,J=_[_.length-1],S={italicAngle:0,emSize:g,usFirstCharIndex:l,usLastCharIndex:J>65535?65535:J,ascent:e,descent:f,surrogates:J>65535?!0:!1},mb["OS/2"]=C(S),mb.post=v({isFixedPitch:fb}),R=nb.length,n=[r(R)],V=[],kb=n[0].byteLength+16*R,p=0;R>p;p+=1)W=mb[nb[p]],W={buffer:W,origLength:W.byteLength},W.buffer=m([W.buffer],4),lb.push(W.buffer),V.push(A({tag:o(nb[p]),checksum:q(W.buffer),offset:kb,length:W.origLength}).buffer),kb+=W.buffer.byteLength;return n=n.concat(V),W=q(m(n.concat(lb))),W=2981146554-W,new DataView(lb[nb.indexOf("head")]).setUint32(8,W),n=m(n.concat(lb)),a.ttf&&(gb.ttf=n),a.eot&&(c=G({ttf:n,checkSumAdjustment:W,name:i,os2:S}),gb.eot=c),a.woff&&(X=F({tableDirectory:V,subTables:lb,ttfSize:n.byteLength,majorVersion:Number(i.version.match(/(\d+)\./)[1]),minorVersion:Number(i.version.match(/\.(\d+)/)[1])}),gb.woff=X),a.svg&&(gb.svg=H()),gb}var d,e,f,g,h,i,j=function(a,b){return isNaN(a)?b:isNaN(b)?a:b>a?a:b},k=function(a,b){return isNaN(a)?b:isNaN(b)?a:a>b?a:b},l=function(a,b){var c,d,e,f=a.length;for(f=f>b.length?f:b.length,e=0;f>e;e+=1)if(c=a.charCodeAt(e),d=b.charCodeAt(e),c!==d)return isNaN(c)?-1:isNaN(d)?1:c-d;return 0},m=function(a,b){var c,d,e=a.length,f=0,g=0,h=0;for(c=0;e>c;c+=1)f+=a[c].byteLength;if(!isNaN(b)&&b>0)for(;f>g;)g+=b;for(d=new Uint8Array(g||f),c=0;e>c;c+=1)d.set(new Uint8Array(a[c]),h),h+=a[c].byteLength;return d.buffer},n=function(a,b,c){var d,e,f,g,h=a.length;for(1===b?f="setUint8":(f="setUint16",b=2),d=new ArrayBuffer(h*b),e=new DataView(d),g=0;h>g;g+=1)e[f](g*b,a.charCodeAt(g),c);return d},o=function(a){var b,c=a.length,d="";for(b=0;c>b;b+=1)d+=a[b].charCodeAt(0).toString(16);return parseInt(d,16)},p=function(a){for(var b=0;a>=2;)a/=2,b+=1;return b},q=function(a){var b,c=new DataView(a),d=a.byteLength,e=0;for(b=0;d>b;b+=4)e+=c.getUint32(b),e>4294967295&&(e=parseInt(e.toString(16).match(/.{8}$/)[0],16));return e},r=function(a){var b,c=new ArrayBuffer(12),d=1,e=0,f=new DataView(c);for(a=a||9;a>d;)e+=1,d*=2;return d/=2,e-=1,b=16*d,f.setUint32(0,65536),f.setUint16(4,a),f.setUint16(6,b),f.setUint16(8,e),f.setUint16(10,16*a-b),c},s=function(a){var b,c,d,e,f,g,h,i,l,n,o=[],p=[],q=[],r=[],s={},t=0,u=function(a,b,c,d){var e,f,g,h=1,i=4;"y"===a&&(h+=1,i+=1),d?(e=d.roundedVal,isNaN(e)&&(e=d.val)):e=0,c.relVal=c.val-e,g=Math.round(c.relVal),c.relVal=c.relVal>0&&.5===c.relVal%1?g-1:g,c.roundedVal=Math.round(d.val+c.relVal),f=d&&0===c.relVal,!f&&c.relVal<256&&c.relVal>-256?(b[h]=1,c.relVal<0?(b[i]=0,c.relVal=-c.relVal):b[i]=1,c.byteLength=1):(b[h]=0,f?(b[i]=1,c.byteLength=0):(b[i]=0,c.byteLength=2))},v=function(a,b){var c,d,e,f,g=b.length,h=new ArrayBuffer(2*g),i=new DataView(h),j=0;for(c=0;g>c;c+=1)d=b[c],e=d[a].byteLength,e&&(f=d[a].relVal,1===e?i.setUint8(j,f):2===e&&i.setUint16(j,f),j+=e);return h.slice(0,j)};for(a=Object.create(a),f=a.length,e=0;f>e;e+=1){for(b=a[e],i=[],g=b.length,t+=g,d=0;g>d;d+=1)i[d]=[],i[d][3]=0,h=b[d],h.offCurve?i[d][0]=0:(i[d][0]=1,b.xMin=j(b.xMin,h.x),b.yMin=j(b.yMin,h.y),b.xMax=k(b.xMax,h.x),b.yMax=k(b.yMax,h.y)),h.x={val:h.x},h.y={val:h.y},0===d?a[e-1]?(l=a[e-1].length,l=a[e-1][l-1]):l=!1:l=b[d-1],u("x",i[d],h.x,l?l.x:!1),u("y",i[d],h.y,l?l.y:!1);for(g=i.length,c=0;g>c;c+=1){for(d=0,l=i[c].join("");256>d&&i[c+d+1]&&l===i[c+d+1].join("");)d+=1;d&&(i[c][3]=1,i[c+1]=d,i.splice(c+2,d-1),g=i.length,c+=1)}b.flags=i,b.xBuffer=v("x",b),b.yBuffer=v("y",b)}for(i=[],c=0,f=a.length;f>c;c+=1){for(b=a[c],s.xMin=Math.round(j(s.xMin,b.xMin)),s.yMin=Math.round(j(s.yMin,b.yMin)),s.xMax=Math.round(k(s.xMax,b.xMax)),s.yMax=Math.round(k(s.yMax,b.yMax)),p.push(b.length+(p[c-1]||-1)),d=0,g=b.flags.length;g>d;d+=1)b.flags[d].length&&(b.flags[d]=parseInt(b.flags[d].reverse().join(""),2));i.push(new Uint8Array(b.flags).buffer),q.push(b.xBuffer),r.push(b.yBuffer)}for(i=m(i),l=new ArrayBuffer(2*p.length+2),n=new DataView(l),c=0,f=p.length;f>c;c+=1)n.setInt16(2*c,p[c]);return l=[l],q=m(q),r=m(r),l.push(i),l.push(q),l.push(r),o=m(l),l=new ArrayBuffer(10),n=new DataView(l),n.setUint16(0,a.length),n.setUint16(2,s.xMin),n.setUint16(4,s.yMin),n.setUint16(6,s.xMax),n.setUint16(8,s.yMax),l=[l],l.push(o),{buffer:m(l,4),bbox:s,contourCount:a.length,pointsCount:t}},t=function(a){function b(a,b){var c,d,e=[],f=a.length;for(d=0,a.sort(function(a,b){return a.code-b.code}),c=1;f>c;c+=1)(a[c].code!==a[c-1].code+1||b&&a[c].idx!==a[c-1].idx+1)&&(e.push(a.slice(d,c)),d=c);return e.push(a.slice(d,f)),e}function c(a,b,c){var d,f;e||(e=new ArrayBuffer(8*v)),f=e.lastOffset||0,d=new DataView(e),d.setUint16(f,a),f+=2,d.setUint16(f,b),f+=2,d.setUint32(f,c),f+=4,e.lastOffset=f}var d,e,f,g,h,i,j,k,l,n,o,q,r,s=[],t=[],u=[],v=2;for(k=a.length,j=0;k>j;j+=1)r=a[j],65535>=r?t.push({idx:j+1,code:r}):u.push({idx:j+1,code:r});if(i=u.length>0,h=t.length>0,i&&h&&(v=4),i&&(u=u.concat(t)),r=new ArrayBuffer(4),d=new DataView(r),d.setUint16(0,0),d.setUint16(2,v),s.push(r),h){for(t.indexOf(65535)<0&&t.push({idx:0,code:65535}),n=b(t),q=n.length,g=new ArrayBuffer(2*(8+4*q)),d=new DataView(g),d.setUint16(0,4),d.setUint16(2,g.byteLength),d.setUint16(4,0),d.setUint16(6,2*q),r=2*Math.pow(2,p(q)),d.setUint16(8,r),d.setUint16(10,p(r/2)),d.setUint16(12,2*q-r),l=14,j=0;q>j;j+=1)d.setUint16(l,n[j][n[j].length-1].code),l+=2;for(d.setUint16(l,0),l+=2,j=0;q>j;j+=1)d.setUint16(l,n[j][0].code),l+=2;for(j=0;q>j;j+=1)d.setInt16(l,n[j][0].idx-n[j][0].code),l+=2;for(j=0;q>j;j+=1)d.setUint16(l,0),l+=2}if(l=4+8*v,r=g?g.byteLength:0,r+=l,h&&c(0,3,l),i&&c(0,4,r),h&&c(3,1,l),i&&c(3,10,r),s.push(e),h&&s.push(g),i){for(o=b(u,!0),q=o.length,f=new ArrayBuffer(16+12*q),d=new DataView(f),d.setUint32(0,786432),d.setUint32(4,f.byteLength),d.setUint32(8,0),d.setUint32(12,q),l=16,j=0;q>j;j+=1)r=o[j],d.setUint32(l,r[0].code),l+=4,d.setUint32(l,r[r.length-1].code),l+=4,d.setUint32(l,r[0].idx),l+=4;s.push(f)}return m(s,4)},u=function(a){var b=new ArrayBuffer(32),c=new DataView(b);return c.setUint32(0,65536),c.setUint16(4,a.numGlyphs||0),c.setUint16(6,a.maxPoints||0),c.setUint16(8,a.maxContours||0),c.setUint16(10,a.maxComponentPoints||0),c.setUint16(12,a.maxComponentContours||0),c.setUint16(14,2),c.setUint16(16,a.maxTwilightPoints||0),c.setUint16(18,a.maxStorage||0),c.setUint16(20,a.maxFunctionDefs||0),c.setUint16(22,a.maxInstructionDefs||0),c.setUint16(24,a.maxStackElements||0),c.setUint16(26,a.maxSizeOfInstructions||0),c.setUint16(28,a.maxComponentElements||0),c.setUint16(30,a.maxComponentDepth||0),b},v=function(a){var b=new ArrayBuffer(32),c=new DataView(b);return c.setInt32(0,196608),c.setUint32(12,a.isFixedPitch?1:0),b},w=function(a){var b=new ArrayBuffer(54),c=new DataView(b),d={val:Math.round((new Date).getTime()/1e3)+2082844800};return d.msb=Math.floor(d.val/4294967295),d.lsb=Math.floor(d.val%4294967295),c.setInt32(0,65536),c.setInt32(4,65536),c.setUint32(12,1594834165),c.setUint8(16,0),c.setUint8(17,11),c.setUint16(18,a.unitsPerEm||0),c.setUint32(20,d.msb),c.setUint32(24,d.lsb),c.setUint32(28,d.msb),c.setUint32(32,d.lsb),c.setInt16(36,a.xMin||0),c.setInt16(38,a.yMin||0),c.setInt16(40,a.xMax||0),c.setInt16(42,a.yMax||0),c.setUint16(44,0),c.setUint16(46,a.lowestRecPPEM||8),c.setInt16(48,2),c.setInt16(50,a.indexToLocFormat||0),b},x=function(a){function b(a){var b=new ArrayBuffer(12),c=new DataView(b);return c.setUint16(0,a.pid),c.setUint16(2,a.sid),c.setUint16(4,a.languageID||0),c.setUint16(6,a.nameID),c.setUint16(8,a.byteLength),c.setUint16(10,a.offset),b}var c,d,e,f,g,h,i,j,k=[],l=[],o=[],p=0,q=[],r={copyright:0,fontFamily:1,subFamily:2,fontId:3,fullName:4,version:5,psName:6,trademark:7,designer:9,description:10,fontURL:11,designerURL:12,license:13,licenseURL:14};for(g in a)i=a[g],f=r[g],!isNaN(f)&&i&&(j=6===f?1:2,q.push(n(i,j)),h=i.length*j,l.push({pid:1,sid:0,nameID:f,offset:p,byteLength:h}),6===f&&(p+=h,h*=2,q.push(n(i))),o.push({pid:3,sid:1,languageID:1033,nameID:f,offset:p,byteLength:h}),p+=h);for(j=function(a,b){return a.nameID-b.nameID},l.sort(j),o.sort(j),l=l.concat(o),e=0,h=l.length;h>e;e+=1)l[e]=b(l[e]);return h?(c=new ArrayBuffer(6),d=new DataView(c),d.setUint16(2,h),k.push(c),l=m(l),k.push(l),q=m(q),k.push(q),c=m(k),d=new DataView(c),d.setUint16(4,l.byteLength+6),c):void 0},y=function(a){var b=new ArrayBuffer(36),c=new DataView(b);return c.setUint32(0,65536),c.setInt16(4,a.ascent||0),c.setInt16(6,a.descent||0),c.setInt16(8,a.lineGap||0),c.setUint16(10,a.advanceWidthMax||0),c.setInt16(12,a.minLeftSideBearing||0),c.setInt16(14,a.minRightSideBearing||0),c.setInt16(16,a.xMaxExtent||0),c.setInt16(18,1),c.setUint16(34,a.numOfLongHorMetrics),b},z=function(a){var b,c,d,e=0,f=a.length;for(b=new ArrayBuffer(4*f),c=new DataView(b),d=0;f>d;d+=1)c.setUint16(e,a[d].aw),c.setInt16(e+2,a[d].lsb),e+=4;return b},A=function(a){var b=new ArrayBuffer(16),c=new DataView(b),d={tag:0,checksum:4,offset:8,length:12},e=function(a){var b,e;for(b in a)a.hasOwnProperty(b)&&(e=d[b],isNaN(e)||c.setUint32(e,a[b]))};return e(a),{buffer:b,set:e}},B=function(a,b){var c,d,e,f=b?4:2,g=a.length,h=b?"setUint32":"setUint16";for(c=new ArrayBuffer(g*f),d=new DataView(c),e=0;g>e;e+=1)d[h](e*f,a[e]*(b?2:1));return c},C=function(a){var b=new ArrayBuffer(96),c=new DataView(b),d=a.emSize,e=Math.sin(a.italicAngle*Math.PI/180),f=.7*d,g=.65*d,h=.14*d,i=.48*d;return c.setUint16(0,3),c.setInt16(2,a.xAvgCharWidth||d||0),a.usWeightClass=a.usWeightClass||400,c.setUint16(4,a.usWeightClass),c.setUint16(6,a.usWidthClass||5),a.fsType=a.fsType||0,c.setUint16(8,a.fsType),c.setInt16(10,g||0),c.setInt16(12,f||0),c.setInt16(14,-e*h),c.setInt16(16,h),c.setInt16(18,g),c.setInt16(20,f),c.setInt16(22,e*i),c.setInt16(24,i),c.setInt16(26,102*d/2048),c.setInt16(28,530*d/2048),c.setInt16(30,0),a.panose=[],a.surrogates&&c.setUint8(46,2),a.unicodeRange1=0,a.unicodeRange2=c.getUint32(46),a.unicodeRange3=0,a.unicodeRange4=0,c.setUint16(62,64),a.italic=0,c.setUint16(64,a.usFirstCharIndex||0),c.setUint16(66,a.usLastCharIndex||0),c.setInt16(68,a.sTypoAscender||a.ascent||0),c.setInt16(70,a.sTypoDescender||a.descent||0),c.setInt16(72,a.sTypoLineGap||a.descent||0),c.setUint16(74,a.usWinAscent||a.ascent||0),c.setUint16(76,a.usWinDescent||-a.descent||0),a.codePageRange1=0,a.codePageRange2=0,c.setUint16(92,32),c.setUint16(94,a.usMaxContext||0),a.panose=0,b},D=function(a){var b,c,d=new ArrayBuffer(4+2*a.length),e=new DataView(d),f=a.length;for(e.setUint16(0,1),e.setUint16(2,f/2),c=4,b=0;f>b;b+=2)e.setUint16(c,a[b]),e.setUint16(c+2,a[b+1]),c+=2;return d},E=function(a,b){function c(a){var c,d,e=a.str.length,f=new ArrayBuffer(2*(e-1)+4),g=new DataView(f);
for(g.setUint16(0,a.id),g.setUint16(2,e),d=4,c=1;e>c;c+=1)g.setUint16(d,b[a.str.charAt(c)]),d+=2;return f}function d(a){var b,d,e,f=[],g=a.length,h=2+2*g,i=new ArrayBuffer(h),j=new DataView(i);for(a.sort(function(a,b){return l(b.str,a.str)}),j.setUint16(0,g),e=2,b=0;g>b;b+=1)j.setUint16(e,h),e+=2,d=c(a[b]),f[b+1]=d,h+=d.byteLength;return f[0]=i,m(f)}var e,f,g,h,i,j,k,n,p,q=new ArrayBuffer(20),r=new ArrayBuffer(14),s=new ArrayBuffer(14),t={},u=[],v=[],w=0;for(k in a)a.hasOwnProperty(k)&&!isNaN(a[k])&&(p=k.charAt(0),t[p]||(t[p]=[],w+=1),t[p].push({id:a[k],str:k}));for(k in t)t.hasOwnProperty(k)&&u.push({key:k,set:t[k]});for(u.sort(function(a,b){return l(a.key,b.key)}),g=new DataView(q),g.setUint16(0,1),g.setUint32(2,o("latn")),g.setUint16(6,8),g.setUint16(8,4),g.setUint16(10,0),g.setUint16(12,0),g.setUint16(14,0),g.setUint16(16,1),g.setUint16(18,0),g=new DataView(r),g.setUint16(0,1),g.setUint32(2,o("liga")),g.setUint16(6,8),g.setUint16(8,0),g.setUint16(10,1),g.setUint16(12,0),g=new DataView(s),g.setUint16(0,1),g.setUint16(2,4),g.setUint16(4,4),g.setUint16(8,1),g.setUint16(10,10),g.setUint16(12,0),p=6+2*w,e=new ArrayBuffer(p),g=new DataView(e),g.setUint16(0,1),g.setUint16(2,p),g.setUint16(4,w),f=new ArrayBuffer(4+2*w),g=new DataView(f),g.setUint16(0,1),g.setUint16(2,w),p=4,i=0;w>i;i+=1)g.setUint16(p,b[u[i].key]||0),p+=2;for(j=f.byteLength+e.byteLength,n=6,g=new DataView(e),i=0;w>i;i+=1)p=d(t[u[i].key]),v.push(p),g.setUint16(n,j),n+=2,j+=p.byteLength;return h=new ArrayBuffer(10),n=10,g=new DataView(h),g.setUint32(0,65536),g.setUint16(4,n),n+=q.byteLength,g.setUint16(6,n),n+=r.byteLength,g.setUint16(8,n),m([h,q,r,s,e,f].concat(v))},F=function(a){var b,c,d,e,f,g,h,i,j=a.tableDirectory.length,k=[];for(f=new ArrayBuffer(44),d=new DataView(f),d.setUint32(0,2001684038),d.setUint32(4,65536),d.setUint16(12,j),d.setUint32(16,a.ttfSize),d.setUint16(20,a.majorVersion||0),d.setUint16(22,a.minorVersion||0),g=44+20*j,e=0;j>e;e+=1)b=new ArrayBuffer(20),c=new DataView(b),h=new DataView(a.tableDirectory[e]),c.setUint32(0,h.getUint32(0)),c.setUint32(4,g),g+=a.subTables[e].byteLength,i=h.getUint32(12),c.setUint32(8,i),c.setUint32(12,i),c.setUint32(16,h.getUint32(4)),k.push(b);return k=m(k),i=m(a.subTables),d.setUint32(8,f.byteLength+k.byteLength+i.byteLength),m([f,k,i])},G=function(a){function b(a){var b=new ArrayBuffer(4),c=[],d=new DataView(b);return d.setUint16(2,2*a.length,!0),c.push(b),c.push(n(a,2,!0)),m(c)}var c,d,e,f,g,h=!0;for(c=new ArrayBuffer(80),d=new DataView(c),d.setUint32(4,a.ttf.byteLength,h),d.setUint32(8,131073,h),f=16,g=a.os2.panose,e=0;e<g.length;e+=1)d.setUint8(f,g[e],h),f+=4;return d.setUint8(26,1,h),d.setUint8(27,a.os2.italic,h),d.setUint32(28,a.os2.usWeightClass,h),d.setUint16(32,a.os2.fsType,h),d.setUint16(34,20556,h),d.setUint32(36,a.os2.unicodeRange1,h),d.setUint32(40,a.os2.unicodeRange2,h),d.setUint32(44,a.os2.unicodeRange3,h),d.setUint32(48,a.os2.unicodeRange4,h),d.setUint32(52,a.os2.codePageRange1,h),d.setUint32(56,a.os2.codePageRange2,h),d.setUint32(60,a.checkSumAdjustment,h),c=m([c,b(a.name.fontFamily),b(a.name.subFamily),b(a.name.version),b(a.name.fullName),new ArrayBuffer(4),a.ttf]),d=new DataView(c),d.setUint32(0,c.byteLength,h),c},H=function(){var a,c,j,k,m,n,o,p,q,r,s=[],t=[];for(c=b(' horiz-adv-x="{{advX}}"'),r=b(' data-tags="{{tags}}"'),j=b('<glyph unicode="{{code}}" d="{{d}}"{{advX}}{{tags}} />'),p=b(['<?xml version="1.0" standalone="no"?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd" >','<svg xmlns="http://www.w3.org/2000/svg">',"<metadata>","<json>","{{metadata}}","</json>","</metadata>","<defs>",'<font id="{{fontId}}" horiz-adv-x="{{defaultAdvX}}">','<font-face units-per-em="{{unitsPerEm}}" ascent="{{ascent}}" descent="{{descent}}" />','<missing-glyph horiz-adv-x="{{defaultAdvX}}" />',"{{glyphs}}","</font></defs></svg>"].join("\n")),n=d.length,k=0;n>k;k+=1)if(a=d[k].advX,a=isNaN(a)||a===h?"":c.fill({advX:a}),q=d[k].tags,q=q&&q.length?r.fill({tags:q.join(", ")}):"",(d[k].d||32===d[k].code)&&(t.push(j.fill({code:"&#x"+d[k].code.toString(16)+";",d:d[k].d,advX:a,tags:q})),d[k].ligatures))for(m=0,o=d[k].ligatures.length;o>m;m+=1)s.push({d:d[k].d,liga:d[k].ligatures[m],advX:a,tags:q});for(s.sort(function(a,b){return l(b.liga,a.liga)}),m=0,o=s.length;o>m;m+=1)s[m]=j.fill({code:s[m].liga,d:s[m].d,advX:s[m].advX,tags:s[m].tags});return t=t.concat(s),t=t.join("\n"),p.fill({metadata:JSON.stringify(i,null,"	"),fontId:i.fontId,defaultAdvX:h,unitsPerEm:g,ascent:e,descent:f,glyphs:t})},I=function(){var a="Generated by IcoMoon";i||(i={}),i.version=i.version?i.version.match(/\d{1,4}\.\d{1,4}/)||"0.0":"0.0",i.version="Version "+i.version,i.fontFamily=i.fontFamily||"icomoon",i.fontId=i.fontId||i.fontFamily,i.psName=i.psName||i.fontFamily,i.subFamily=i.subFamily||"Regular",i.fullName=i.fontFamily,/regular/i.test(i.subFamily)||(i.fullName+=" "+i.subFamily),i.description?-1===i.description.indexOf(a)&&(i.description=i.description+" "+a):i.description=a};return function(a){var b={};return b.set=function(a){return d=a.glyphs,e=a.ascent,f=a.descent,g=a.unitsPerEm,h=a.defaultAdvX,i=a.metadata?JSON.parse(JSON.stringify(a.metadata)):{},I(),this},b.generate=function(a){return a||(a={woff:!0,ttf:!0,eot:!0,svg:!0}),c(a)},a&&b.set(a),b}}]),angular.module("file",["scriptLoader"]).factory("fileSaver",["scriptLoader","$q","$http",function(a,b,c){function d(a,b){g?i.then(function(){var c=new Blob([b]);c.encoding="base64",saveAs(c,a)}):c.post("http://icomoon.io/fileMirror/mirror2.php",{file:"string"==typeof b?b:b.toString(!0),ext:a.match(/\.(\w+)$/)[1]},{transformResponse:!1}).then(function(a){location.href=a.data})}var e=function(a,b){this.files={},this.root="",a&&this.load(a,b)};e.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"},e.defaults={base64:!1,binary:!1,dir:!1,date:null,compression:null},e.prototype=function(){var a=function(a,b,c){this.name=a,this.data=b,this.options=c};a.prototype={asText:function(){var a=this.data;return null===a||"undefined"==typeof a?"":(this.options.base64&&(a=f.decode(a)),this.options.binary&&(a=e.prototype.utf8decode(a)),a)},asBinary:function(){var a=this.data;return null===a||"undefined"==typeof a?"":(this.options.base64&&(a=f.decode(a)),this.options.binary||(a=e.prototype.utf8encode(a)),a)},asUint8Array:function(){return e.utils.string2Uint8Array(this.asBinary())},asArrayBuffer:function(){return e.utils.string2Uint8Array(this.asBinary()).buffer}};var b=function(a,b){var c,d="";for(c=0;b>c;c++)d+=String.fromCharCode(255&a),a>>>=8;return d},c=function(){var a,b,c={};for(a=0;a<arguments.length;a++)for(b in arguments[a])arguments[a].hasOwnProperty(b)&&"undefined"==typeof c[b]&&(c[b]=arguments[a][b]);return c},d=function(a){return a=a||{},a.base64===!0&&null==a.binary&&(a.binary=!0),a=c(a,e.defaults),a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),a},g=function(b,c,f){var g=h(b);if(g&&i.call(this,g),f=d(f),f.dir||null===c||"undefined"==typeof c)f.base64=!1,f.binary=!1,c=null;else if(e.support.uint8array&&c instanceof Uint8Array)f.base64=!1,f.binary=!0,c=e.utils.uint8Array2String(c);else if(e.support.arraybuffer&&c instanceof ArrayBuffer){f.base64=!1,f.binary=!0;var j=new Uint8Array(c);c=e.utils.uint8Array2String(j)}else f.binary&&!f.base64&&(f.optimizedBinaryString!==!0&&(c=e.utils.string2binary(c)),delete f.optimizedBinaryString);return this.files[b]=new a(b,c,f)},h=function(a){"/"==a.slice(-1)&&(a=a.substring(0,a.length-1));var b=a.lastIndexOf("/");return b>0?a.substring(0,b):""},i=function(a){if("/"!=a.slice(-1)&&(a+="/"),!this.files[a]){var b=h(a);b&&i.call(this,b),g.call(this,a,null,{dir:!0})}return this.files[a]},j=function(a,c,d){var f,g,h=c!==a.name,i=a.asBinary(),j=a.options;f=j.date.getHours(),f<<=6,f|=j.date.getMinutes(),f<<=5,f|=j.date.getSeconds()/2,g=j.date.getFullYear()-1980,g<<=4,g|=j.date.getMonth()+1,g<<=5,g|=j.date.getDate();var k=null!==i&&0!==i.length;if(d=j.compression||d,!e.compressions[d])throw d+" is not a valid compression method !";var l=e.compressions[d],m=k?l.compress(i):"",n="";return n+="\n\x00",n+=h?"\x00\b":"\x00\x00",n+=k?l.magic:e.compressions.STORE.magic,n+=b(f,2),n+=b(g,2),n+=k?b(this.crc32(i),4):"\x00\x00\x00\x00",n+=k?b(m.length,4):"\x00\x00\x00\x00",n+=k?b(i.length,4):"\x00\x00\x00\x00",n+=b(c.length,2),n+="\x00\x00",{header:n,compressedData:m}};return{filter:function(b){var d,e,f,g,h=[];for(d in this.files)this.files.hasOwnProperty(d)&&(f=this.files[d],g=new a(f.name,f.data,c(f.options)),e=d.slice(this.root.length,d.length),d.slice(0,this.root.length)===this.root&&b(e,g)&&h.push(g));return h},file:function(a,b,c){if(1===arguments.length){if(a instanceof RegExp){var d=a;return this.filter(function(a,b){return!b.options.dir&&d.test(a)})}return this.filter(function(b,c){return!c.options.dir&&b===a})[0]||null}return a=this.root+a,g.call(this,a,b,c),this},folder:function(a){if(!a)return this;if(a instanceof RegExp)return this.filter(function(b,c){return c.options.dir&&a.test(b)});var b=this.root+a,c=i.call(this,b),d=this.clone();return d.root=c.name,d},remove:function(a){a=this.root+a;var b=this.files[a];if(b||("/"!=a.slice(-1)&&(a+="/"),b=this.files[a]),b)if(b.options.dir)for(var c=this.filter(function(b,c){return c.name.slice(0,a.length)===a}),d=0;d<c.length;d++)delete this.files[c[d].name];else delete this.files[a];return this},generate:function(a){a=c(a||{},{base64:!0,compression:"STORE",type:"base64"});var d=a.compression.toUpperCase();if(!e.compressions[d])throw d+" is not a valid compression method !";var g=[],h=[],i=0;for(var k in this.files)if(this.files.hasOwnProperty(k)){var l=this.files[k],m=this.utf8encode(l.name),n="",o="",p=j.call(this,l,m,d);n=e.signature.LOCAL_FILE_HEADER+p.header+m+p.compressedData,o=e.signature.CENTRAL_FILE_HEADER+"\x00"+p.header+"\x00\x00"+"\x00\x00"+"\x00\x00"+(this.files[k].options.dir===!0?"\x00\x00\x00":"\x00\x00\x00\x00")+b(i,4)+m,i+=n.length,h.push(n),g.push(o)}var q=h.join(""),r=g.join(""),s="";s=e.signature.CENTRAL_DIRECTORY_END+"\x00\x00"+"\x00\x00"+b(h.length,2)+b(h.length,2)+b(r.length,4)+b(q.length,4)+"\x00\x00";var t=q+r+s;switch(a.type.toLowerCase()){case"uint8array":return e.utils.string2Uint8Array(t);case"arraybuffer":return e.utils.string2Uint8Array(t).buffer;case"blob":return e.utils.string2Blob(t);case"base64":return a.base64?f.encode(t):t;default:return t}},crc32:function(a,b){if(""===a||"undefined"==typeof a)return 0;var c=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"==typeof b&&(b=0);var d=0,e=0;b=-1^b;for(var f=0,g=a.length;g>f;f++)e=255&(b^a.charCodeAt(f)),d=c[e],b=b>>>8^d;return-1^b},clone:function(){var a=new e;for(var b in this)"function"!=typeof this[b]&&(a[b]=this[b]);return a},utf8encode:function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);128>d?b+=String.fromCharCode(d):d>127&&2048>d?(b+=String.fromCharCode(192|d>>6),b+=String.fromCharCode(128|63&d)):(b+=String.fromCharCode(224|d>>12),b+=String.fromCharCode(128|63&d>>6),b+=String.fromCharCode(128|63&d))}return b},utf8decode:function(a){for(var b="",c=0,d=0,e=0,f=0;c<a.length;)d=a.charCodeAt(c),128>d?(b+=String.fromCharCode(d),c++):d>191&&224>d?(e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3);return b}}}(),e.compressions={STORE:{magic:"\x00\x00",compress:function(a){return a},uncompress:function(a){return a}}},e.support={arraybuffer:function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array}(),uint8array:function(){return"undefined"!=typeof Uint8Array}(),blob:function(){if("undefined"==typeof ArrayBuffer)return!1;var a=new ArrayBuffer(0);try{return 0===new Blob([a],{type:"application/zip"}).size}catch(b){}try{var c=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return c.append(a),0===c.getBlob("application/zip").size}catch(b){}return!1}()},e.utils={string2binary:function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(255&a.charCodeAt(c));return b},string2Uint8Array:function(a){if(!e.support.uint8array)throw new Error("Uint8Array is not supported by this browser");for(var b=new ArrayBuffer(a.length),c=new Uint8Array(b),d=0;d<a.length;d++)c[d]=a.charCodeAt(d);return c},uint8Array2String:function(a){if(!e.support.uint8array)throw new Error("Uint8Array is not supported by this browser");for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},string2Blob:function(a){if(!e.support.blob)throw new Error("Blob is not supported by this browser");var b=e.utils.string2Uint8Array(a).buffer;try{return new Blob([b],{type:"application/zip"})}catch(c){}try{var d=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder);return d.append(b),d.getBlob("application/zip")}catch(c){}throw new Error("Bug : can't construct the Blob.")}};var f=function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return{encode:function(b){for(var c,d,e,f,g,h,i,j="",k=0;k<b.length;)c=b.charCodeAt(k++),d=b.charCodeAt(k++),e=b.charCodeAt(k++),f=c>>2,g=(3&c)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+a.charAt(f)+a.charAt(g)+a.charAt(h)+a.charAt(i);return j},decode:function(b){var c,d,e,f,g,h,i,j="",k=0;for(b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");k<b.length;)f=a.indexOf(b.charAt(k++)),g=a.indexOf(b.charAt(k++)),h=a.indexOf(b.charAt(k++)),i=a.indexOf(b.charAt(k++)),c=f<<2|g>>4,d=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(c),64!=h&&(j+=String.fromCharCode(d)),64!=i&&(j+=String.fromCharCode(e));return j}}}(),g=Blob&&Blob.constructor&&"download"in document.createElement("a"),h=b.defer(),i=h.promise;return g&&(window.saveAs?h.resolve:i=a.load("bower_components/FileSaver/FileSaver.min.js")),function(){var a=new e;return{add:function(b,c,d){return a.file(b,c,d),this},save:function(a,b){b?d(a,b):d(a,this.getArrayBuffer())},getArrayBuffer:function(){return a.generate({type:"arraybuffer"})}}}}]),angular.module("moonui",["tmpl"]).filter("zpad",function(){return function(a,b){var c=/\-/.test(a);if(b=parseInt(b,10),isNaN(b))return a;a=String(a);var d,e=a.replace(/\.|\-/g,"").length;for(d=0;b-e>d;d+=1)a="0"+a;return c&&(a="-"+a.replace(/\-/g,"")),a}}).filter("miSearch",function(){var a=function(a,b){var c,d,e,f,g=b.length,h=-1,i=0,j=0;if(a=a.replace(/\s*/,"").toLowerCase(),b=b.replace(/\s*/,"").toLowerCase(),!b.length)return!1;for(c=0;g>c;c+=1)d=b[c],e=a.indexOf(d,h+1),c&&e!==h+1&&(f=!0),-1!==e?(h=e,i+=1):j+=1;return i&&!j&&!f||(i-j)/a.length>.5};return function(b,c){var d,e,f,g;if(!c||!b)return!1;for("string"==typeof b&&(b=b.replace(/\s*/,"").replace(/,+/,","),b=b.split(",")),"string"==typeof c&&(c=c.replace(/\s*/,"").replace(/,+/,","),c=c.split(",")),f=c.length,d=0;f>d;d+=1){for(e=0,g=b.length;g>e&&!a(b[e],c[d]);e+=1);if(e===g)return!1}return!0}}).directive("miEditable",function(){return{priority:50,require:"ngModel",link:function(a,b,c,d){b.attr("contenteditable",!0),b.bind("input",function(){a.$apply(function(){d.$setViewValue(b.text())})}),b.bind("keydown",function(a){13===a.which&&(a.preventDefault(),b[0].blur()),a.stopPropagation()}),a.$watch(function(){return d.$modelValue},function(){b.html(d.$modelValue)})}}}).directive("miPopup",function(){return{restrict:"A",require:"^?miAbsorbClicks",link:function(a,b,c,d){var e,f,g=angular.element(b[0]).next(),h=function(){g.attr("style","opacity: 0"),setTimeout(function(){g.addClass("hidden"),g.removeAttr("style")},500)},i=function(){g.removeClass("hidden"),e=!0},j=function(){clearTimeout(f),f=setTimeout(function(){e||h(),e=!1},10)};d&&d.addCallback&&d.addCallback(j),angular.element(document).bind("click",j),h(),g.bind("click",function(a){var b=a.target.tagName.toUpperCase();a.stopPropagation(),("A"===b||"BUTTON"===b||"I"===b)&&(h(),"A"!==a.target.tagName.toUpperCase()&&a.preventDefault())}),"focus"===c.miPopup?!function(){var a,c,d,f;a=b.find("input"),a.length||(a=b),a.bind("focus",i),a.bind("click",function(){e||(g.toggleClass("hidden"),e=!0)}),a.bind("blur",function(a){var b,i,j=a.relatedTarget;if(!j)return e&&h(),void 0;if(f||!function(){var a,b,c,d,e=[];for(f=g.find("button"),d=f.length,b=0;d>b;b+=1)e[b]=f[b];for(a=g.find("a"),d+=a.length,b=f.length,c=0;d>b;b+=1,c+=1)e[b]=a[c];f=e}(),i=f.length,c||(c=f[0]),d||(d=f[i-1],angular.element(d).bind("blur",function(a){var b=a.relatedTarget;b!==f[i-2]&&b!==c&&h()})),f){for(b=0;i>b;b+=1)if(j===f[b])return;b===i&&h()}})}():b.bind("click",function(){g.toggleClass("hidden"),e=!0}),b.bind("keydown",function(a){13===a.which?(g.toggleClass("hidden"),e=!0):27===a.which&&h()})}}}).directive("miNumber",["$filter",function(a){return{restrict:"E",scope:{radix:"&",min:"&",max:"&",def:"&",zpad:"&",validator:"&",modelVal:"=model"},template:'<input type="text" ng-model="viewVal" />',link:function(b,c,d){var e,f,g,h=a("zpad"),i=Number(b.radix())||10,j=Number(b.min()),k=Number(b.max()),l=Number(b.zpad())||0,m=!1,n=Number(b.def())||0,o=c.children("input"),p=10===i,q=d.invalidClass,r=b.validator&&b.validator();2>i&&(i=2);var s=function(a,c,g){var m=!1,s=b.viewVal;if(p)try{s=b.$eval(b.viewVal)}catch(t){s=n}else s=parseInt(s,i);isNaN(s)&&(g?(m=!0,s=b.viewVal):s=n),m||isNaN(a)||(s+=parseInt(a,10)),!isNaN(k)&&s>k?g?m=!0:s=k:!isNaN(j)&&j>s&&(g?m=!0:s=j),!m&&r&&(r(s,n)||(g?m=!0:s=n)),m&&q?(o.addClass(q),o[0].setCustomValidity("invalid")):q&&(o.removeClass(q),o[0].setCustomValidity("")),b.$apply(function(){b.viewVal=h(s.toString(i),l),d.charInput&&!m&&f.val(String.fromCodePoint(s))}),g||(c=isNaN(c)?0:c,clearTimeout(e),e=setTimeout(function(){b.$apply(function(){b.modelVal=n=s})},c))};o.bind("keydown",function(a){var b;40===a.which?(b=-1,a.preventDefault()):38===a.which&&(b=1,a.preventDefault()),a.shiftKey&&(b*=i),b&&s(b,0,q)}).bind("change",function(){s()}).bind("focus",function(){m=!0}).bind("blur",function(){m=!1,q&&s()}).bind("mousewheel",function(a){if(a.stopPropagation(),m){var b=a.wheelDeltaY>0?1:-1;a.shiftKey&&(b*=i),a.preventDefault(),s(b,500,q)}}).bind("input",function(){q&&s(0/0,0,q)}),isNaN(b.modelVal)||(n=b.modelVal),b.modelVal=n,b.viewVal=h(n,l),b.$watch("modelVal",function(a){isNaN(a)||(b.viewVal=h(a.toString(i),l),d.charInput&&f.val(String.fromCodePoint(a)),n=a)}),d.charInput&&(f=angular.element('<input type="text" maxlength="1" />'),f.val(String.fromCodePoint(n)),g=function(a){r(a,n)&&(b.$apply(function(){n=b.modelVal=a,b.viewVal=h(a.toString(i),l)}),f[0].setCustomValidity(""),q&&f.removeClass(q))},f.bind("input",function(){var a;a=f.val().codePointAt(0),document.activeElement===f[0]&&r&&(a&&r(a,n)?g(a):(f[0].setCustomValidity("invalid"),q&&f.addClass(q)))}).bind("change",function(){var a=f.val();return a&&f[0].validity.valid?(a=a.codePointAt(0),n!==a&&g(a),void 0):(f.val(String.fromCodePoint(b.modelVal)),f[0].setCustomValidity(""),q&&f.removeClass(q),void 0)}).bind("click",function(){f[0].select()}),c.parent().after(angular.element('<label class="'+d.charInput+'"></label>').append(f)))}}}]).directive("miSelectAll",function(){return{link:function(a,b){b.bind("focus",function(){setTimeout(function(){b[0].select()})})}}}).directive("miPresets",function(){return{restrict:"E",transclude:!0,template:'<label mi-popup="focus"><mi-number min="min" max="max" def="def" zpad="zpad" model="val"></mi-number><span ng-transclude></span></label><ul><li ng-repeat="p in presets"><button type="button" ng-click="update(p)" value="{{p}}">{{p}}</button></li></ul>',scope:{val:"=model",min:"=",max:"=",def:"=",zpad:"=",getPresets:"&presets"},link:function(a,b){a.update=function(b){a.val=b};var c=function(){a.presets=a.getPresets(),a.$apply()};b.bind("click",c),b.find("input").bind("focus",c)}}}).directive("miStyle",function(){return{restrict:"E",link:function(a,b){var c,d=function(){return c=b.html()},e=angular.element("<style></style>");b.after(e),e=e[0],b.css("display","none"),a.$watch(d,function(){e.stylesheet?e.stylesheet.cssText=c:e.innerHTML=c})}}}).directive("miLink",function(){return{restrict:"E",replace:!0,transclude:!0,template:'<span><span ng-show="!href" ng-transclude></span><a ng-show="href" href="{{href}}" ng-transclude></a></span>',scope:{href:"@"}}}).directive("miFile",function(){return{restrict:"E",scope:{onOpen:"&",focused:"="},template:'<input type="file" multiple />',link:function(a,b,c){var d=b.children("input"),e=new RegExp(c.typeRegex);d[0].addEventListener("change",function(b){var c=b.target.files,f=0,g=new FileReader,h=[],i=function(b){e.test(c[f].type||c[f].name)&&h.push({file:b.target.result,type:c[f].type,name:c[f].name}),f+=1,f===c.length?(a.$apply(function(){a.onOpen({files:h})}),d[0].value=""):(g=new FileReader,g.onload=i,g.readAsText(c[f]))};g.onload=i,g.readAsText(c[f])},!1),c.focused&&d.bind("focus",function(){a.$apply(function(){a.focused=!0})}).bind("blur",function(){a.$apply(function(){a.focused=!1})})}}}).directive("miBoxSelector",function(){return{restrict:"E",scope:{map:"=",mode:"@",onApply:"&"},transclude:!0,template:"<div ng-transclude></div>",link:function(a,b,c){var d,e,f=[],g=!1,h=!1,i={},j={},k=0/0,l=c.boxClass||"mi-boxed",m={},n=c.selectedClass||"mi-selected",o=[],p=[],q=0,r=function(b){a.$apply(function(){a.onApply({selection:o,mode:b}),o=[]})},s=function(a){return a.offsetLeft<=m.x2&&a.offsetLeft+a.offsetWidth>=m.x1&&a.offsetTop<=m.y2&&a.offsetTop+a.offsetHeight>=m.y1?!0:a.offsetTop>m.y2||m.y1>a.offsetHeight+a.offsetTop?0/0:!1},t=function(){var a,c,d,e=b.find("mi-box"),f=e.length,g=[],h=1;if(!f)return g;for(a=0;f>a;a+=1)"none"!==e[a].style.display&&g.push({el:e[a],idx:a});for(e=g,g=[],f=e.length,c=e[0].offsestTop,m.x1=Math.min(i.x,j.x),m.x2=Math.max(i.x,j.x),m.y1=Math.min(i.y,j.y),m.y2=Math.max(i.y,j.y),a=k||0;f>a;a+=1)if(q+=1,1===h&&e[a].el.offsetTop>c&&(h=a),d=s(e[a].el))isNaN(k)&&(k=a),g.push({index:e[a].idx,element:angular.element(e[a].el)});else{if(isNaN(d)&&!isNaN(k))break;a+=h-1}for(a=k-1||-1;a>-1;a-=1)if(d=s(e[a].el))g.push({index:e[a].idx,element:angular.element(e[a].el)});else if(isNaN(d))break;return g},u=function(){var c,d,e,f=a.map,g=b.find("mi-box"),h=g.length,i=[];if(!h||!f||h!==f.length)return 500>q&&(q+=1,setTimeout(u,0)),void 0;if(q=0,e=JSON.stringify(f),JSON.stringify(p)!==e){for(c=0;h>c;c+=1)JSON.stringify(p[c])!==JSON.stringify(f[c])&&i.push(c);for(p=JSON.parse(e),h=i.length,c=0;h>c;c+=1)d=i[c],e=angular.element(g[d]),f[d].order?e.addClass(n):e.removeClass(n)}};b.bind("mousedown",function(a){return k=0/0,g=!0,a.preventDefault(),i.x=a.pageX,i.y=a.pageY,!1}),document.body.addEventListener("mouseup",function(b){var c,i,j,m,p,q=a.mode;if(h=!1,g=!1,k=0/0,f.length){for(i=0,m=f.length;m>i;i+=1)c=f[i],c.element.removeClass(l),"delete"===q?c.element.removeClass(n).remove():"select"===q&&c.element.toggleClass(n),p=c.index,j=o.indexOf(p),j>0?o.splice(j,1):o.push(c.index);f=[],clearTimeout(e),e=setTimeout(function(){r(q)},300)}d={x:b.pageX,y:b.pageY}},!1),b.bind("mouseup",function(c){var g,h,m,p,q,s,u;if(!f.length){for(q=a.mode,h="delete"===q,j.x=c.pageX,j.y=c.pageY,g=t(),k=0/0,m=g.length,1===m&&d&&c.shiftKey&&(i=d,g=t(),h||(g=g.slice(1)),m=g.length),b.find("mi-box").removeClass(l),p=0;m>p;p+=1)h&&!c.shiftKey?g[p].element.removeClass(n).remove():"select"===q&&g[p].element.toggleClass(n),s=g[p].index,u=o.indexOf(s),u>0?o.splice(u,1):o.push(g[p].index+(h&&!c.shiftKey?o.length:0));clearTimeout(e),e=setTimeout(function(){r(q)},300)}}),b.bind("mousemove",function(a){var c;if(g)for(h=!0,clearTimeout(e),j.x=a.pageX,j.y=a.pageY,f=t(),b.find("mi-box").removeClass(l),c=0;c<f.length;c+=1)f[c].element.addClass(l)}),window.addEventListener("scroll",function(){clearTimeout(e);var b=a.mode;o.length&&(e=setTimeout(function(){r(b)},100))},!1),a.$watch("map",function(){u()},!0),u()}}}).directive("miModelDelay",function(){return{require:"ngModel",link:function(a,b,c,d){function e(){a.$apply(function(){d.$setViewValue(b.text()||b.val())})}var f,g=c.miModelDelay;b.unbind("input").unbind("change").unbind("keydown"),"blur"!==g&&(g=Number(g)||300),b.bind("change, blur",function(){e()}),"number"==typeof g&&b.bind("input",function(){clearTimeout(f),f=setTimeout(e,g)})}}}).directive("miTags",function(){return{priority:10,require:"ngModel",link:function(a,b,c,d){function e(){b.val(d.$modelValue),f&&b.html(d.$modelValue)}var f=b.is("span");d.$parsers.push(function(a){var b=[],c=a;return c?(c=c.replace(/\s*,\s*/g,",").replace(/,+/g,", ").trim().replace(/^,+|,+$/,""),c=c.split(", "),c.forEach(function(a){a&&-1===b.indexOf(a)&&b.push(a)}),b.join(", ")):""}),f=b.is("span"),d.$render=e,b.bind("change, blur",function(){d.$setViewValue(f?b.html():b.val()),e()})}}}).directive("miUnique",function(){return{priority:5,require:"ngModel",link:function(a,b,c,d){var e=a[c.miUnique]||{},f=!b[0].hasAttribute("contenteditable"),g="string"==typeof c.miTags;d.$parsers.push(function(h){var i,j,k,l,m,n,o=[];if(g){for(n in e)e.hasOwnProperty(n)&&(o=o.concat(e[n]));for(m=h.split(/,\s*/),n=e[a.$id]||[],k=m.length,i=0;k>i;i+=1)if(-1!==o.indexOf(m[i])&&-1===n.indexOf(m[i])){j=!1;break}i===k&&(j=!0)}else{for(n in e)n!==a.$id&&e.hasOwnProperty(n)&&o.push(e[n]);l=h.replace(/\s*/g,""),j=-1===o.indexOf(l)}return j?(d.$setValidity("unique",!0),c.miInvalidClass&&b.removeClass(c.miInvalidClass),h):(document.activeElement===b[0]?(d.$setValidity("unique",!1),c.miInvalidClass&&b.addClass(c.miInvalidClass)):f?b.val(d.$modelValue):b.html(d.$modelValue),d.$modelValue)}),b.bind("change, blur",function(){d.$setViewValue(f?b.val():b.text()),d.$setValidity("unique",!0),b.removeClass(c.miInvalidClass)}),a.$watch(function(){return d.$modelValue},function(b){b?e[a.$id]=g?b.split(/,\s*/):b.replace(/\s*/g,""):delete e[a.$id]})}}}).directive("miTooltip",["$parse",function(a){var b,c=1e3,d=c;return{link:function(e,f,g){var h,i=f[0];f.bind("mouseenter",function(){var c=function(){var b,c,e,f,j=a(g.miTooltip)();b=i.getBoundingClientRect(),h=angular.element("<div></div>"),h.addClass(j.class||"tooltip"),h.text(j.text),angular.element(document.body).append(h),e=h[0].getBoundingClientRect(),f=j.hasOwnProperty("marginTop")?b.top+b.height+(Number(j.marginTop)||0):b.top-b.height-(Number(j.marginBottom)||0),c=j.hasOwnProperty("marginRight")?b.left+b.width-e.width-Number(j.marginRight):b.left+b.width/2-e.width/2,h.css({left:c+"px",top:f+"px"}),d=0};clearTimeout(b),d?b=setTimeout(c,d):c()}).bind("mouseleave",function(a){var e;clearTimeout(b),h&&h.remove(),e=a.toElement,e&&(0===d&&e.hasAttribute("mi-tooltip")||(d=c))}).bind("click",function(){clearTimeout(b),d=c,h&&h.remove()})}}}]).directive("miAbsorbClicks",function(){return{controller:["$scope",function(a){a.callbacks=[],this.addCallback=function(b){a.callbacks.push(b)}}],link:function(a,b){var c,d;b.bind("click",function(b){for(b.stopPropagation(),d=a.callbacks.length,c=0;d>c;c+=1)a.callbacks[c]()})}}}).directive("miFocusWhen",function(){return{scope:!0,link:function(a,b,c){var d;a.$watch(function(){return c.miFocusWhen},function(){clearTimeout(d),d=setTimeout(function(){try{"true"===c.miFocusWhen&&b[0].focus()}catch(a){}},100)})}}}).directive("miGrid",["template",function(a){return{restrict:"E",scope:{left:"@",top:"@",width:"@",height:"@",gridSize:"@"},link:function(b,c){function d(a,b,c,d,h){var i=[],j=d/h,k=[],l=0,m=0;if(!(1>j)&&c&&d){for(;c>l;)k.push(g.fill({x:Math.round(l)})),l+=j;for(k.push(g.fill({x:Math.round(c)}));d>m;)i.push(f.fill({y:Math.round(m)})),m+=j;return i.push(f.fill({y:Math.round(d)})),e.fill({left:a,top:b,width:c,height:d,hLines:i.join(""),vLines:k.join("")})}}var e=a('<div class="miGrid" style="left: {{left}}px; top: {{top}}px; width: {{width}}px; height: {{height}}px;">{{hLines}}{{vLines}}</div>'),f=a('<div class="hLine" style="top: {{y}}px"></div>'),g=a('<div class="vLine" style="left: {{x}}px"></div>');b.$watch(function(){return b.left+b.top+b.width+b.height+b.gridSize},function(){c.html(d(Number(b.left),Number(b.top),Number(b.width),Number(b.height),Number(b.gridSize))||"")})}}}]).directive("miVisibleBox",function(){return{link:function(a,b,c){function d(){var b=a[c.miVisibleBox];b&&(b.processing=!0),50>g?(setTimeout(function(){e()},300),g+=1):g=0}function e(){var b,e,f;try{if(b=h.getBoundingClientRect(),!b.width||!b.height)return c.miVisibleBoxWatch&&d(),void 0;e=h.offsetLeft,isNaN(e)&&(f=h.parentElement||h.parentNode,e=(f.offsetWidth-b.width)/2),a[c.miVisibleBox]={width:Math.round(b.width),height:Math.round(b.height),left:Math.round(e),top:0,processing:!1},setTimeout(function(){a.$apply()},100)}catch(g){return d(),void 0}}var f,g=0,h=b[0],i={width:0,height:0};a.$watch(function(){return b.attr("viewBox")+b.attr("style")+c.miVisibleBoxWatch},function(){e()}),window.addEventListener("resize",function(){a.$apply(function(){a[c.miVisibleBox]=i}),clearTimeout(f),f=setTimeout(function(){e(),a.$apply()},500)},!1)}}}),"#library"===location.hash&&(location.hash="#/select/library"),angular.module("icomoonApp",["ui.router","storage","svg","font","tmpl","file","moonui","cloud"]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/select"),a.state("select",{url:"/select",templateUrl:"views/main.html",controller:"MainCtrl",resolve:{icomoon:["session",function(a){return a.load()}]}}).state("select.font",{url:"/font",templateUrl:"views/font.html",controller:"FontCtrl"}).state("select.image",{url:"/image",templateUrl:"views/image.html",controller:"ImageCtrl"}).state("select.library",{url:"/library",templateUrl:"views/lib.html",controller:"LibCtrl",resolve:{iconSets:["$q","$http",function(a,b){var c=a.defer();
return b.get("icomoon-lib/library.json").then(function(a){c.resolve(a.data)}),c.promise}]}}).state("projects",{url:"/projects",templateUrl:"views/projects.html",controller:"ProjectsCtrl",resolve:{icomoon:["session",function(a){return a.load()}]}})}]),angular.module("icomoonApp").controller("MsgCtrl",["$scope","message",function(a,b){a.message=b}]),angular.module("icomoonApp").factory("session",["$q","$http","$rootScope","$timeout","storage","cloud","scriptLoader",function(a,b,c,d,e,f,g){function h(b){var c=a.defer();return j=!0,f.hasCloudAccess().then(function(a){a=a||-1,b&&(b.time=b.time||0),!b||a>b.time?f.getSession().then(function(a){c.resolve(a)},function(){c.resolve()}):a!==b.time?(f.storeSession({session:JSON.stringify(b)}),c.resolve()):c.resolve()},function(){c.resolve()}),c.promise.then(function(){j=!1}),c.promise}var i,j,k,l,m,n,o,p={};return p.load=function(){var d=a.defer();return k?d.resolve(k):e.load("icomoon",function(a){h(a).then(function(c){c||a&&a.projects?(k=c||a,d.resolve(k)):b.get("icomoon-lib/presets.json").then(function(a){k=a.data,d.resolve(k)}),d.promise.then(function(a){f.hasCloudAccess().then(function(){l=JSON.parse(JSON.stringify(a)),i=g.load("components/jsondiffpatch/jsondiffpatch.min.js"),i.then(function(){jsondiffpatch.config.objectHash=function(a){return a.id||0}})})})}),c.$apply()}),d.promise},p.save=function(b){return m||(m=a.defer()),d.cancel(n),n=d(function(){function a(){f.hasCloudAccess().then(function(){return i}).then(function(){j||(d.cancel(o),o=d(function(){function a(b){var c;b.error?c=!0:d!==b.time&&(c=!0),c?(d=k.time,f.storeSession({session:JSON.stringify(k)}).then(a)):(l=JSON.parse(JSON.stringify(k)),j=!1)}var b=JSON.stringify(jsondiffpatch.diff(l,k)),c=JSON.stringify(k),d=k.time,e={};return b?(c.length<b.length?e.session=c:e.diff=b,j=!0,f.storeSession({diff:JSON.stringify(b)}).then(a),void 0):(j=!1,void 0)},1e3))}),e.save("icomoon",b,function(){m&&m.resolve(),m=!1})}b=b||k,k=b,k.time?(k.time=(new Date).getTime(),a()):f.hasCloudAccess().then(function(){k.time=(new Date).getTime()}).always(a)},300),m.promise},p.reset=function(){var b=a.defer();return e.clear(function(){c.$apply(function(){k=!1,b.resolve()})}),b.promise},p.isSyncing=function(){return j},p}]),angular.module("icomoonApp").factory("message",["$q",function(a){var b,c;return{show:function(d,e,f){return"string"==typeof d?c=d:(c=d.message,e=d.firstButton,f=d.secondButton),this.visible=!0,b=a.defer(),this.firstButton=e&&e.caption?{caption:e.caption,focused:e.focused}:!1,this.secondButton=f&&f.caption?{caption:f.caption,focused:f.focused}:!1,b.promise},getMessage:function(){return c},hide:function(a){this.visible=!1,b.resolve(a)}}}]),angular.module("icomoonApp").factory("hotkeys",function(){function a(a){var b;return a=a.toLowerCase(),1===a.length?/[0-9a-z]/.test(a)?a.toUpperCase().charCodeAt(0):-1:(b={cmd:91,command:91,shift:16,ctrl:17,control:17,alt:18,option:18,opt:18,left:37,up:38,right:39,down:40,esc:27},b[a]||-1)}function b(a,b){var c,d=a.length,e=b.length;if(d!==e)return!1;for(c=0;e>c;c+=1)if(-1===a.indexOf(b[c]))return!1;return!0}function c(a){var c,d,e,f,h=g.length;for(d=0;h>d;d+=1)for(c=g[d].keys,f=c.length,e=0;f>e;e+=1)if(b(c[e],a))return g[d];return!1}function d(a){return(224===a||93===a)&&(a=91),a}function e(a){return/input/i.test(a.tagName)?!0:!1}var f=[],g=[],h={};return document.addEventListener("keydown",function(a){var b,g,h;h=d(a.which),g=f.indexOf(h),-1===g&&f.push(h),b=c(f),!b||!b.down||b.waitForUp&&b.up||e(a.target)||(b.scope?b.scope.$apply(b.down):b.down(),b.waitForUp=!0,a.preventDefault())}),document.addEventListener("keyup",function(a){var b,g,h;h=d(a.which),b=f.indexOf(h),-1!==b?(g=c(f),f.splice(b,1),g&&(g.waitForUp=!1,g.up&&!e(a.target)&&(g.scope?g.scope.$apply(g.up):g.up(),a.preventDefault()))):(g=c([h]),g&&g.up&&!e(a.target)&&(g.scope?g.scope.$apply(g.up):g.up(),a.preventDefault())),91===h&&(f=[])},!1),h.clear=function(){g=[]},h.add=function(b,c){var d,e,f,h,i,j,k=b.slice(0);for(d=0,h=k.length;h>d;d+=1){for(j=k[d].keys,"string"==typeof j&&(k[d].keys=j=[j]),e=0,i=j.length;i>e;e+=1)for(j[e]=j[e].trim().split(/\s+\+?\s*/),f=0;f<j[e].length;f+=1)j[e][f]=a(j[e][f]);c&&(k[d].scope=c)}g=g.concat(k)},h}),angular.module("cloud",[]).factory("cloud",["$http","$q",function(a,b){var c,d,e,f,g={};return g.auth=function(){var c=b.defer();return f?c.resolve():a({method:"POST",url:"http://i.icomoon.io/authstat",withCredentials:!0}).then(function(a){var b=a.data;b.auth?(g.uid=b.uid,c.resolve()):c.reject()},function(){c.reject()}),c.promise},g.hasCloudAccess=function(){var d=b.defer();return c?d.resolve(c):a({method:"POST",url:"http://i.icomoon.io/getsessiontime",withCredentials:!0}).then(function(a){var b=a.data;b.error?d.reject():(d.resolve(b.time),c=b.time)},function(){d.reject()}),d.promise},g.storeSession=function(c){var d=b.defer();return a({method:"POST",url:"http://i.icomoon.io/storesession",withCredentials:!0,data:c}).then(function(a){d.resolve(a.data)},function(){d.reject()}),d.promise},g.getSession=function(){var c=b.defer();return a({method:"POST",url:"http://i.icomoon.io/getsession",withCredentials:!0}).then(function(a){c.resolve(a.data)},function(){c.reject()}),c.promise},g.getPurchases=function(){var c=b.defer();return a({method:"POST",url:"http://i.icomoon.io/purchases",withCredentials:!0}).then(function(a){c.resolve(a.data)},function(){c.reject()}),c.promise},g.host=function(c){var f=b.defer(),g=c.hash;return g===d?(f.resolve(e),f.promise):(d=g,a({method:"POST",url:"http://i.icomoon.io/host",withCredentials:!0,data:c}).then(function(a){e=a.data,f.resolve(e)},function(){f.reject()}),f.promise)},g}]),angular.module("icomoonApp").directive("miIcon",["template",function(a){var b=a(['<div class="icon{{wide}}">','<svg width="{{width}}" height="{{height}}" viewBox="0 0 {{width}} {{height}}" style="margin-left: calc(50% - {{offset}}em)">',"<g>{{paths}}</g>","</svg>","</div>"].join("")),c=a('<path d="{{d}}" />');return{restrict:"E",scope:{icon:"=",height:"@"},link:function(a,d){a.$watch("icon",function(){var e,f,g,h,i,j=[];for(h=a.icon.paths,g=h.length,e=0;g>e;e+=1)j.push(c.fill({d:h[e]}));f=Number(a.height),i=a.icon.width||f,d.html(b.fill({width:i,height:f,paths:j.join(""),wide:i>1.5*f?" icon-wide":"",offset:i/f/2}))},!0)}}}]),angular.module("icomoonApp").controller("MainCtrl",["$scope","$timeout","$state","$q","cloud","template","fileSaver","message","hotkeys","glyphs","svgPath","session","icomoon",function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){var b,c,d;if(!a||!a.length)return 0;for(c=a.length,d=a[0].id||0,b=1;c>b;b+=1)d=a[b].id>d?a[b].id:d;return d+1}function o(a){var b,c;for(a.selection=[],c=a.icons.length,b=0;c>b;b+=1)a.selection[b]||(a.selection[b]={}),a.selection[b].order=0,isNaN(a.selection[b].id)&&(a.selection[b].id=n(a.selection)),isNaN(a.icons[b].id)&&(a.icons[b].id=n(a.icons))}function p(a){var b,c,d,e,f=0,g="",h=[],i=0;for(a&&!isNaN(a.setIdx)?(f=a.setIdx,b=f+1):b=t.length,f;b>f;f+=1)for(c=t[f].selection.length,a&&a.selectionHash&&(g+=t[f].id),d=0;c>d;d+=1)t[f].selection[d].order?a&&a.selectionHash?g+=JSON.stringify(t[f].icons[d]):a&&a.onlyCount?i+=1:(e=t[f].selection[d],e.prevSize=e.prevSize||t[f].prevSize,h.push({icon:t[f].icons[d],properties:e})):(t[f].selection[d].order=0,isNaN(t[f].selection[d].id)&&(t[f].selection[d].id=n(t[f].selection)));return a&&a.selectionHash?g:a&&a.onlyCount?i:(h.sort(function(a,b){return a.properties.order-b.properties.order}),b=h.length,h)}function q(){t=y.iconSets,a.project=y,a.pref=y.preferences,a.fontPref=y.preferences.fontPref,a.imagePref=y.preferences.imagePref,a.edit&&a.edit.refresh&&a.edit.refresh()}function r(a,b,c,d){var e,f={id:b};return a.paths?c!==z?(e=k(a.paths),e.viewBox={width:a.width||c,height:c},e=e.scale(z/c),f.width=e.viewBox.width,f.paths=e.getPathData(!0)):(f.paths=a.paths,a.width&&(f.width=a.width)):(c=c||a.viewBox.height,c!==z&&a.scale(z/c),f.paths=a.getPathData(!0),isNaN(a.viewBox.width)||a.viewBox.width===z||(f.width=a.viewBox.width)),a.tags&&(f.tags=a.tags),a.defaultCode&&(f.defaultCode=a.defaultCode),f.grid=d||0,f}function s(a){var b,c,d,e,f,g,h={};if("string"==typeof a){for(e=t.length,b=0;e>b;b+=1)if(t[b].metadata.name===a)return t[b];return s()}if(a=a||{},h.id=n(t),h.metadata=a.metadata||{},delete h.metadata.iconsHash,!h.metadata.name){for(f=[],b=0,e=t.length;e>b;b+=1)f.push(t[b].metadata.name);if(g="Untitled Set",-1!==f.indexOf(g)){for(d=2;-1!==f.indexOf(g+" "+d);)d+=1;g=g+" "+d}h.metadata.name=g}for(h.height=z,c=a.icons||[],e=c.length,h.prevSize=a.prevSize||32,g=n(h.icons),b=0;e>b;b+=1)c[b]=r(c[b],g+b,a.height,c[b].grid||h.metadata.grid);return h.icons=c,a.selection?h.selection=a.selection:o(h),t.unshift(h),h}var t,u,v,w,x,y=m.projects[m.currentProject],z=1024;e.auth().then(function(){a.signedIn=!0},function(){a.signedIn=!1}),a.onLine=navigator.onLine,a.isSyncing=l.isSyncing,e.hasCloudAccess().then(function(){a.cloudAccess=!0},function(){a.cloudAccess=!1}),a.scrollPositions={},a.$on("$stateChangeSuccess",function(){var b=c.current.name;a.tab=b,a.search="",setTimeout(function(){window.scrollTo(0,a.scrollPositions[b])},0)}),a.$on("$stateChangeStart",function(){a.scrollPositions[c.current.name]=window.scrollY}),y||(y={metadata:{name:"Untitled Project 1",lastOpened:(new Date).getTime()},iconSets:[]},m.projects.push(y)),a.getSetHash=function(a){var b,c=a.icons,d=c.length,e=[];for(b=0;d>b;b+=1)e.push(c[b].paths.join("")),c[b].tags&&e.push(c[b].tags.join(""));return e.join("").hashCode()},a.clearSelection=function(){var a,b=t.length;for(a=0;b>a;a+=1)o(t[a])},a.selectAllNone=function(a){var b,c,d,e,f=0,g=t[a].selection,h=0;for(d=g.length,e=d/2,c=0;d>c&&(g[c].order?h+=1:f+=1,!(h>e));c+=1)if(f>e){b=!0;break}g.forEach(function(a){b?(a.order=v,v+=1):a.order=0})},a.getSelectedIcons=p,a.getSelectionCount=function(){return p({onlyCount:!0})},a.getSelectionHash=function(){return p({selectionHash:!0})},function(){var b,c,d,e,f,g,h,i,j,l,m,p=[];for(a.normSize=z,a.mode="select",a.edit={},a.visiblePanels={},u=[],u.idx=0,y.preferences=y.preferences||{},y.preferences.fontPref=y.preferences.fontPref||{prefix:"icon-",metadata:{},showGlyphs:!0,metrics:{emSize:1024,baseline:6.25,whitespace:50}},y.preferences.imagePref=y.preferences.imagePref||{},u.size=y.preferences.historySize||100,y.preferences.historySize=u.size,q(),"undefined"==typeof y.preferences.showCodes&&(y.preferences.showCodes=!0),g=t.length,j=[],d=0;g>d;d+=1){for((isNaN(t[d].id)||-1!==j.indexOf(t[d].id))&&(t[d].id=n(t)),j.push(t[d].id),t[d].prevSize=t[d].prevSize||32,b=t[d].icons,f=t[d].height,h=b.length,f!==z?(l=z/f,t[d].height=z):l=0,c=[],e=0;h>e;e+=1)(isNaN(b[e].id)||-1!==c.indexOf(b[e].id))&&(b[e].id=n(b)),c.push(b[e].id),b[e].grid=b[e].grid||0,l&&(i=k(b[e].paths),i.viewBox={width:b[e].width||f,height:f},i.scale(l),b[e].paths=i.getPathData(!0),b[e].width=i.viewBox.width,i.viewBox.width===z&&delete b[e].width,delete b[e].height);if(isNaN(b.nextId)&&(b.nextId=h||0),b=t,b[d].selection)for(h=b[d].selection.length,e=0;h>e;e+=1)m=b[d].selection[e],m&&m.order&&p.push(m);else o(b[d])}for(p.sort(function(a,b){return a.order-b.order}),d=0,g=p.length;g>d;d+=1)p[d].order=d+1;v=p.length+1||1}(),a.changeIcons=function(b,c,d){var e,f,g,h,i,j,k=[],l=t[c],m="delete"===d,n="edit"===d,o=function(a){i=h[a].order,i?(h[a].order=0,delete h[a].code):(h[a].order=v,v+=1)},p=function(a){k.push(f[a])},q=function(a){h[a]=0,l.icons[a]=0};if(l){for(h=l.selection,f=l.icons,j=m?q:n?p:o,e=0;e<b.length;e+=1)j(b[e]);m?(j=function(a){return!!a},l.icons=f.filter(j),l.selection=h.filter(j)):n&&(g=a.edit,1===k.length?(g.icons=l.icons,g.idx=b[0]):(g.icons=k,g.idx=0),g.set=l,a.visiblePanels.edit=!0,g.refresh=function(){i=a.visiblePanels.edit,a.changeIcons(b,c,d),a.visiblePanels.edit=i})}},function(){var c;a.$watch("project",function(d,e){b.cancel(w),c=c||e,w=b(function(){x?x=!1:(u.idx>-1&&(u[u.idx]=c,c=!1),u.idx+=1,u[u.idx]=JSON.parse(JSON.stringify(d)),u.splice(u.idx+1),u.length>u.size+1&&(u.shift(),u.idx-=1)),a.history.noUndo=u.idx<2,a.history.noRedo=u.idx>u.length-2,l.save(m)},300)},!0)}(),a.history=function(b){u.idx+b>-1&&u.idx+b<u.length&&(JSON.stringify(u[u.idx+b])===JSON.stringify(y)?(u.splice(u.idx+b,1),0>b&&(u.idx-=1)):(u.idx+=b,y=u[u.idx],q(),x=!0)),a.history.noUndo=u.idx<2,a.history.noRedo=u.idx>u.length-2},a.history.noUndo=!0,a.history.noRedo=!0,a.newSetFromSelection=function(a,b){var c,d,e=[],f=[],g={icons:e};for(a=a||p(),c=0,d=a.length;d>c;c+=1)e[c]=a[c].icon,f[c]=a[c].properties;b&&(g.selection=f),s(g),window.scrollTo(0)},a.removeSet=function(b,c){var d;c&&(d=p({setIdx:b})),t.splice(b,1),c&&a.newSetFromSelection(d,!0)},a.import=function(b,c){function e(b,c){var d;if(!b)return w.reject(),w.promise;d=a.getGridSize(o),d=d&&d[0],"number"!=typeof d&&(d=!1);var e=r(b,n(o.icons),!1,d);!e.tags&&c&&(e.tags=[c]),o.icons.unshift(e),o.selection.unshift({order:0,id:n(o)})}var f,g,i,k,l,m,o,p,q,u,v,w=d.defer(),x=/^[\d\-_\.\s]+|\.[^\.]*$/g,y=/image.svg/;if(!b)return w.reject(),w.promise;for(k=b.length,k||h.show("Please select images or fonts in SVG, or JSONs exported by IcoMoon."),isNaN(c)?u=!0:(o=t[c],a.setIdx=0/0),f=0;k>f;f+=1)if(y.test(b[f].type))if(m=j(b[f].file),m.length>1)if(o)for(i=0,l=m.length;l>i;i+=1)e(m[i]);else q=m.metadata||{},q.name||(q.name=b[f].name.replace(x,"")),s({icons:m,metadata:q});else o||(2>k&&t.length>0?(o=t[0],0!==o.metadata.name.indexOf("Untitled Set")&&(o=s())):o=s()),e(m[0],b[f].name.replace(x,""));else if(q=JSON.parse(b[f].file),p=q.IcoMoonType,"icon-set"===p)s({icons:q.icons,height:q.height,metadata:q.metadata,prevSize:q.prevSize});else if("selection"===p){for(g=[],v=[],i=0,l=q.icons.length;l>i;i+=1)g[i]=q.icons[i].icon,v[i]=q.icons[i].properties;a.clearSelection(),s({icons:g,selection:v,metadata:q.metadata,height:q.height,prevSize:q.prevSize})}return u&&(window.scrollTo(0),a.search=""),w.resolve(),w.promise},a.showInfo=function(b){a.visiblePanels.info=!0,a.metadata=b.metadata,a.set=b},a.getGridSize=function(b){var c,d,e,f;if(b=b||a.set,b&&b.icons){for(f=b.icons.length,c=0;f>c;c+=1)if(d=b.icons[c],e){if(-1===e.indexOf(d.grid)&&(e.push(d.grid),e.length>2))break}else e=[d.grid];if(e)return e.toString=function(){var a;return this.length?this.length>1?(a=this.slice(0),a.forEach(function(a){a=a||"unknown"}),"mixed ("+a.join(", ")+")"):1===this.length?this[0]||"unknown":void 0:"unknown"},e.sort()}},a.editMetadata=function(b){b&&(a.metadata=b.metadata),a.visiblePanels.info=!1,a.visiblePanels.metadata=!0},a.showGridReset=function(){a.visiblePanels.info=!1,a.visiblePanels.gridReset=!0},a.resetGrids=function(b,c){c=c||a.set,b=b||0,c.icons.forEach(function(a){a.grid=b}),a.visiblePanels.gridReset=!1},a.getMultiples=function(a,b){var c,d,e,f,g,h=[];for("number"==typeof a&&(a=[a]),e=a.length,b=Math.floor((b||4)/e)||1,d=0;e>d;d+=1){if(f=a[d],!f||isNaN(f)){if(1===e)return[16,20,24,32];f=16}for(c=0;b>c&&(g=f*(c+1),!(g>100));c+=1)-1===h.indexOf(g)&&h.push(g)}return 1===h.length&&(h=[h[0]/2,h[0]]),h},a.downloadSet=function(b){var c;b=b||a.set,c=JSON.parse(JSON.stringify(b)),delete c.id,delete c.selection,delete c.invisible,c.icons.forEach(function(a){delete a.id}),c.preferences=y.preferences,c.IcoMoonType="icon-set",c.metadata.iconsHash=a.getSetHash(b),g().save(c.metadata.name+".json",JSON.stringify(c,null,"	"))},function(){var b,c,d=-1!==navigator.userAgent.indexOf("Mac OS X");i.clear(),i.add([{keys:"opt",down:function(){b=a.mode,a.mode="edit"},up:function(){a.mode=b||c,b=!1}},{keys:["ctrl + alt","cmd + opt"],down:function(){c=b||a.mode,a.mode="delete"},up:function(){a.mode=c}},{keys:["ctrl + z","cmd + z"],down:function(){a.history(-1)}},{keys:["ctrl + y","ctrl + shift + z","cmd + shift + z","cmd + y"],down:function(){a.history(1)}}],a),a.tooltips=d?{delMode:"Remove (Cmd + Opt)",editMode:"Edit (Opt)",undo:"Undo (Cmd + Z)",redo:"Redo (Cmd + Shift + Z)"}:{delMode:"Remove (Ctrl + Alt)",editMode:"Edit (Alt)",undo:"Undo (ctrl + Z)",redo:"Redo (ctrl + Shift + Z)"},a.tooltips.selectMode="Select"}(),a.vendorPrefix=function(){var a=window.getComputedStyle(document.documentElement,"");return(Array.prototype.slice.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1]}(),a.newProject=function(){var a,b,c=[],d=1,e="Untitled Project ";for(m.projects.forEach(function(a){c.push(a.metadata.name)});-1!==c.indexOf(e+d);)d+=1;b=(new Date).getTime(),a={name:e+d,lastOpened:b,created:b},m.projects.push({metadata:a,iconSets:[]}),m.currentProject=m.projects.length-1,l.save(m).then(function(){location.reload()})},f().get("image.svg")}]),angular.module("icomoonApp").controller("EditCtrl",["$scope","glyphs","template","fileSaver","svgPath","hotkeys","message",function(a,b,c,d,e,f,g){function h(a){var b=p,c=a.width||p;a.translate(-c/2,-b/2)}function i(a){var b=p,c=a.width||p;a.translate(c/2,b/2)}function j(a){o.icons&&o.icons.forEach(function(b){b.grid=b.grid||a})}function k(a){h(n),a(),i(n),o.icons[o.idx].paths=n.getPathData(!0)}function l(){return p/(2*a.icon.grid||64)}var m,n,o=a.edit,p=a.normSize;a.pref.gridSize=a.pref.prevSize||16,function(){var b;a.$watch("edit",function(c){var d,f=c.idx;c.icons&&c.icons.length&&(d=c.icons[f],a.icon=d,a.noNext=f>c.icons.length-2,a.noPrev=1>f,d.paths&&(n=e(d.paths),n.width=d.width||p),a.tags=d.tags?d.tags.join(", "):""),b!==f&&(b=f,a.pathIdx=0/0)},!0)}(),a.$watch(function(){return a.icon&&a.icon.grid},function(a){m=a}),a.$watch(function(){return a.visiblePanels.edit},function(a){a||j(m)}),a.$watch("tags",function(b){b&&b.split&&(a.icon.tags=b.split(", "))}),a.ccw=function(){k(function(){n.rotate(-90,a.pathIdx)})},a.cw=function(){k(function(){n.rotate(90,a.pathIdx)})},a.flipHorizontal=function(){k(function(){n.transform({a:-1,d:1},a.pathIdx)})},a.flipVertical=function(){k(function(){n.transform({a:1,d:-1},a.pathIdx)})},a.scaleDown=function(){var b=l(),c=1-2*b/p;k(function(){n.scale(c,c,a.pathIdx)})},a.scaleUp=function(){var b=l(),c=1/(1-2*b/p);k(function(){n.scale(c,c,a.pathIdx)})},a.increaseWidth=function(){var a=l();o.icons[o.idx].width=o.icons[o.idx].width||p,o.icons[o.idx].width+=a},a.decreaseWidth=function(){var a=l();o.icons[o.idx].width=o.icons[o.idx].width||p,o.icons[o.idx].width-=a},a.translate=function(b,c){var d=l();b=Number(b),b=b?b>0?1:-1:0,c=Number(c),c=c?c>0?1:-1:0,k(function(){n.translate(b*d,c*d,a.pathIdx)})},a.selectPath=function(b){a.pathIdx=b===a.pathIdx?0/0:b},a.next=function(){o.icons&&o.idx<o.icons.length-1&&(o.idx+=1),j(m)},a.prev=function(){o.icons&&o.idx>0&&(o.idx-=1),j(m)},a.replace=function(c){var d,e,f;return c&&c[0]?(d=c[0],f=b(d.file),1===f.length&&(e=f[0],a.normSize!==e.viewBox.height&&e.scale(a.normSize/e.viewBox.height),o.icons[o.idx].paths=f[0].getPathData(!0)),void 0):(a.visiblePanels.edit=!1,g.show("Please select an SVG image.").then(function(){a.visiblePanels.edit=!0}),void 0)},a.makeCopy=function(b){var c=JSON.parse(JSON.stringify(b));c.id=o.set.nextId,o.set.nextId+=1,o.set.selection.splice(0,0,{order:0/0}),o.icons.splice(0,0,c),a.visiblePanels.edit=!1},a.downloadIcon=function(a){var b,e,f,g,h=d(),i=a.height||p,j=c().get("image.svg"),k=a.width||p;for(g=a.paths.slice(0),b=0,e=g.length;e>b;b+=1)g[b]={d:g[b]};f=a.tags,f&&(f=f[0]),f||(f="icomoon"),j.then(function(a){h.add(f+".svg",a.fill({paths:g,width:k,height:i})),h.save("IcoMoon.zip")})},a.getWidth=function(){var b=a.icon;return b?Math.round(60*((b.width||p)/(b.height||p)))+"%":0},f.add([{keys:"left",down:a.prev},{keys:"right",down:a.next}],a)}]),angular.module("icomoonApp").controller("FontCtrl",["$scope","$state","$q","$timeout","svgPath","font","template","fileSaver","cloud",function(a,b,c,d,e,f,g,h,i){function j(a){var b,c,d,e;if("string"==typeof a)c=a?v.idx[a]:1;else{if("number"==typeof a)return-1===u.indexOf(a)?(u.push(a),a):j(a+1);c=1}for(e=v[c],d=e[1],b=e[0];d>b;b+=1)if(-1===u.indexOf(b))return u.push(b),b;return c+1<v.length&&j(c+1),0}function k(a){var b=2;if(-1!==s.indexOf(a)){for(;-1!==s.indexOf(a+b);)b+=1;a+=b}return s.push(a),a}function l(b){var c,d,f,g,h,i,j,k,l,m=a.fontPref.metrics.baseline,n=a.fontPref.metrics,o=[],p={};for(n?(n=n.emSize,c=-m/100*n):(n=1024,c=-64),i=t.length,f=0;i>f;f+=1)k=t[f],g=k.icon,j=e(g.paths.slice(0)),j.viewBox={width:g.width||a.normSize,height:g.height||a.normSize},b&&(d=g.grid||k.properties.prevSize||h||16,h=d,l=p[d]||m%(100/d)*n/100,p[d]=l),b&&l&&j.translate(0,-l),o.push({svgPath:j});return{glyphs:o,emSize:n,ascent:n+c,descent:c,unitsPerEm:n,defaultAdvX:n}}function m(a){var b,c,d,e=[],f=0,g={};for(a=a||t,c=a.length,b=0;c>b;b+=1)d=a[b].icon.grid||0,g.hasOwnProperty(d)||(g[d]={idx:f,arr:[]},f+=1),g[d].arr.push(a[b]);for(d in g)g.hasOwnProperty(d)&&e.push(g[d]);for(e.sort(function(a,b){return a.idx-b.idx}),a=[],b=0,c=e.length;c>b;b+=1)a=a.concat(e[b].arr);return a}function n(){var b,c;b=l(!0),b.glyphs.length?(c=f(b).generate({woff:!0}).woff,URL&&URL.createObjectURL&&Blob?(URL.revokeObjectURL(a.localFont),a.localFont=URL.createObjectURL(new Blob([c],{type:"application/font-woff"}))):a.localFont="data:application/font-woff;charset=utf-8;base64,"+c.toString(!0)):a.localFont=""}function o(){a.ttfSize=t.length<500?q(!0).ttfSize+" bytes":"unknown"}function p(){var b,c,d,e,g,h,i,j,k=a.fontPref.metadata,m=a.fontPref;for(k||(k={},m.metadata=k),g=l(!0),d=0,h=g.glyphs.length;h>d;d+=1)b=g.glyphs[d],e=t[d],b.code=e.properties.code,32===b.code&&(c=!0),a.pref.showLiga&&(i=e.properties.ligatures,i&&(b.ligatures=i.split(/,\s*/))),m.includeMetadata&&(b.tags=e.tags);return c||g.glyphs.push({code:32,advX:m.metrics.whitespace/100*(m.metrics.emSize||1024)}),m.includeMetadata||(k={fontFamily:k.fontFamily||"icomoon"}),g.metadata=k,j=f(g).generate()}function q(b){var d,e,f,i=p(),j=a.fontPref,k=j.metadata&&j.metadata.fontFamily||"icomoon",l=b?"":"fonts/",m=h(),n=j.prefix||j.postfix||"icon-",o=c.defer(),q=c.defer(),r=c.defer(),s=c.defer(),u=c.defer(),v=c.defer(),w=c.defer(),x=c.defer();return j.includeMetadata||(i.svg=i.svg.replace(/(<metadata>)[\s\S]*(<\/metadata>)/,"$1Generated by IcoMoon$2")),j.useClassSelector&&(n=j.classSelector||".icon",n=n.slice(1)),m.add(l+k+".ttf",i.ttf),m.add(l+k+".woff",i.woff),m.add(l+k+".eot",i.eot),m.add(l+k+".svg",i.svg),f=i.ttf.byteLength,d=JSON.stringify(t),e=JSON.parse(d),d=(d+JSON.stringify(j)+a.project.metadata.name).hashCode(),e.sort(function(a,b){return a.properties.order-b.properties.order}),e.forEach(function(a,b){delete a.properties.tempChar,a.properties.order=b+1,delete a.icon.id}),e={IcoMoonType:"selection",icons:e,height:a.normSize,metadata:{name:j.metadata.fontFamily,url:j.metadata.fontURL,designer:j.metadata.designer,designerURL:j.metadata.designerURL,license:j.metadata.license,licenseURL:j.metadata.licenseURL},preferences:a.pref},b||m.add("selection.json",JSON.stringify(e,null,"	")),g().get("demo.html").then(function(c){var e,f,h,p,y,z,A,B,C,D,E,F=-1,G=a.pref.showLiga?[]:!1,H=[],I=[],J=[],K=[];for(G&&(f=function(a){a&&H.push({tag:a,code:D.code})}),p=0,z=a.glyphSets.length;z>p;p+=1)D=a.glyphSets[p],I[p]={},I[p].tmpGlyphs=D,J[p]={idx:p+1,size:D[0].properties.prevSize},I[p].grid=D.grid||"Unknown";for(h={prefix:j.prefix,postfix:j.postfix,noLiga:G?!1:!0,selector:j.useClassSelector?n+" ":""},h.prefix||h.postfix||(h.prefix="icon-"),p=0;z>p;p+=1)for(I[p].glyphs=[],F=0,A=I[p].tmpGlyphs.length;A>F;F+=1)if(B=I[p].tmpGlyphs[F].properties,D=Object.create(h),D.glyphName=B.name.replace(/\s+/g,"").split(/,/),D.code=B.code.toString(16),D.char=B.code,D.liga=B.ligatures,G&&D.liga.split(/,\s*/).forEach(f),D.fontSizeIdx=p+1,D.glyphName.length>1)for(e=D.glyphName,y=0;y<e.length;y+=1)E=Object.create(D),E.glyphName=e[y],K.push(E),I[p].glyphs.push(E);else D.glyphName=D.glyphName[0],K.push(D),I[p].glyphs.push(D);b?(x.resolve(),o.resolve(),q.resolve(),w.resolve()):(m.add("demo.html",c.fill({fontName:k,glyphsCount:t.length,sets:I,ie7:j.ie7?[]:!1,liga:G,ligaClass:n})),x.resolve(),g().get("demo.js").then(function(a){m.add("demo-files/demo.js",a.fill({})),o.resolve()}),g().get("demo.css").then(function(a){m.add("demo-files/demo.css",a.fill({fontSizes:J})),w.resolve()}),g().get("readme.txt").then(function(a){m.add("Read Me.txt",a.fill({})),q.resolve()})),C={fontsDir:l,fontFamily:k},j.embed&&(C.ttf=i.ttf.toString(!0),C.woff=i.woff.toString(!0)),g().get("style.css").then(function(a){var c={fontFamily:k,glyphs:K,fontFace:"",fontFaceB64:""};j.useClassSelector?c.selector=j.classSelector:(j.postfix&&(c.selector='[class$="'+j.postfix+'"], [class*="'+j.postfix+' "]'),(!c.selector||j.prefix)&&(c.selector='[class^="'+n+'"], [class*=" '+n+'"]')),j.embed?c.fontFaceB64=C:c.fontFace=C,b?(c.fontFace.hash=d.toString(36),c.fontFace.cacheBuster="?"+c.fontFace.hash):(c.fontFace.hash="",c.fontFace.cacheBuster=""),c.liga=G,m.add("style.css",a.fill(c)),r.resolve()}),j.ie7?(g().get("ie7.css").then(function(a){m.add("ie7/ie7.css",a.fill({glyphs:K})),u.resolve()}),g().get("ie7.js").then(function(a){m.add("ie7/ie7.js",a.fill({glyphs:K,fontFamily:k,prefix:j.prefix})),s.resolve()})):(s.resolve(),u.resolve()),G?g().get("liga.js").then(function(a){m.add("liga.js",a.fill({ligaTags:H,ligaClass:n})),v.resolve()}):v.resolve()}),{hash:d,fontName:k,zip:m,ttfSize:f,promise:c.all([o.promise,q.promise,r.promise,s.promise,u.promise,v.promise,w.promise,x.promise])}}var r,s,t,u=[],v=[[33,126],[58880,65535],[983040,1048575]];v.idx={bLatin:0,pua:1,spua:2},a.quickUsage={statusMessage:"Working"+String.fromCharCode(8230)},a.hostFont=function(b){var c,d,e=a.fontPref,f=q(!0);d=f.ttfSize,(e.autoHost||b)&&(e.autoHost=!0,a.ttfSize=d+" bytes",c=a.project.metadata.name,e.quickUsageToken&&e.quickUsageToken[c]||(e.quickUsageToken={}),f.promise.then(function(){var b={hash:f.hash,zip:f.zip.getArrayBuffer().toString(!0),name:c,token:e.quickUsageToken[c]};e.ssl&&(b.ssl=!0),a.quickUsage.icon="sync fgc-warning",a.quickUsage.statusMessage="Uploading"+String.fromCharCode(8230),i.host(b).then(function(b){a.quickUsage.url=b.path+"/style.css",a.quickUsage.url2=b.path2?b.path2+"/style.css":!1,e.quickUsageToken[c]=b.token,a.quickUsage.icon="check fgc-success",a.quickUsage.statusMessage="Ready"},function(){a.quickUsage.icon="warning fgc-error",a.quickUsage.statusMessage="Upload Failed"})}))},function(){var b,c,e=0,f=[],g=!0;a.$watch(function(){return t=a.getSelectedIcons(),JSON.stringify(t)},function(){var h,i,l,p,q,v,w,x,y,z=0/0,A=t.length,B=a.getSelectionHash(),C=!1;if(u=[],s=[],a.glyphNames={empty:""},a.ligatures={},(A>e||A===e&&B!==b)&&(C=!0),!C)for(i=0;A>i;i+=1)if(y=t[i],!y.properties.tempChar||!r[i]){C=!0;break}for(C&&(e=A,r=[],a.glyphSets=[]),b=a.getSelectionHash(),a.ligaWarning=!1,a.numOfGlyphs=A,i=0;A>i;i+=1)y=t[i],w=y.icon,h=y.properties.code,isNaN(h)||(y.properties.code=j(h));for(t=m(),i=0;A>i;i+=1)y=t[i],w=y.icon,h=y.properties.code,isNaN(h)&&(h=w.defaultCode,isNaN(h)&&(h="pua"),h=j(h),y.properties.code=h),x=y.properties.name,x||(!x&&w.tags&&(x=w.tags[0]),x||(x="uni"+h.toString(16).toUpperCase()),/\s/.test(x)&&(x=x.replace(/\s/,"-")),y.properties.name=k(x)),C?(y.properties.tempChar=String.fromCodePoint(i+57344),r[i]={grid:w.grid,properties:y.properties,tags:w.tags}):(r[i].properties=y.properties,r[i].grid=w.grid),v=y.properties.ligatures,"string"==typeof v?(r[i].ligaWarning=!1,v=v.replace(/,\s/g,""),/[^a-z]/i.test(v)&&(r[i].ligaWarning=!0,a.ligaWarning=!0)):y.properties.ligatures="";for(C&&!g?n():r&&r.splice(A),l=-1,i=0,q=r.length;q>i;i+=1)r[i].grid!==z&&(z=r[i].grid,l+=1,f[l]=f[l]||[],f[l].grid=z,-1!==l&&f[l].splice(p),p=0),f[l][p]=r[i],0===p&&(f[l][0].properties.prevSize=f[l][0].properties.prevSize||z||32),1===p&&f[l][1]&&(f[l][1].properties.prevSize=f[l][0].properties.prevSize),p+=1;p&&-1!==l&&f[l].splice(p),f.splice(l+1),a.glyphSets=f,g=!1,a.fontPref.autoHost?(d.cancel(c),c=d(function(){a.hostFont()},2e3)):o()});var h;a.$watch(function(){return a.fontPref},function(b){var e=b.metrics,f=JSON.stringify(e);a.fontPref.autoHost&&(d.cancel(c),c=d(function(){a.hostFont()},2e3)),b.useClassSelector&&(b.classSelector=b.classSelector||"",b.classSelector="."+(b.classSelector.replace(/[^a-zA-Z\-\_0-9]/g,"").replace(/^[^a-zA-Z_\-]/,"").replace(/^-([^a-zA-Z_])/,"")||"icon")),h!==f&&(h=f,e&&!isNaN(e.baseline)&&n())},!0)}(),a.download=function(){var a=q();a.promise.then(function(){a.zip.save(a.fontName+".zip")})},a.validateCode=function(a,b){var c=u.indexOf(a);return 0>a?!1:-1===c||u[c]===b?!0:!1},a.showEncoding=function(b,c){var d,e=0;for(d=0;b>d;d+=1)e+=a.glyphSets[d].length;e+=c,a.firstGlyphIdx=e,a.firstGlyphName=r[e].properties.name,a.visiblePanels.encoding=!0},a.resetCodes=function(b,c){var d,e=r.length;for(b=a.firstGlyphIdx||0,c=a.fontPref.resetPoint||0,u.splice(b),d=b;e>d;d+=1)c=j(c),r[d].properties.code=c,c+=1;a.visiblePanels.encoding=!1},a.removeGlyph=function(a){a.properties.order=0},a.max=Math.max,a.$on("$stateChangeStart",function(){URL&&URL.createObjectURL&&Blob&&URL.revokeObjectURL(a.localFont)}),g().get("demo.html.tmpl"),g().get("demo.css.tmpl"),g().get("demo.js.tmpl"),g().get("style.css.tmpl"),g().get("readme.txt")}]),angular.module("icomoonApp").controller("ImageCtrl",["$scope","$state","$q","$filter","message","scriptLoader","fileSaver","template","svgPath",function(a,b,c,d,e,f,g,h,i){function j(a,b,c){var d,e,f=0,g=a[0].height,h=0,i=[],j=[],k=a.length,l=[];for(isNaN(c)&&(c=Math.floor(g/2)),e=0;k>e;e+=1)d=e%b,i[d]=Math.max(i[d]||0,a[e].width),0===d&&(f+=g+c);for(f-=c,e=0;e<i.length;e+=1)l[e]=h,h+=i[e]+c;for(h-=c,g+=c,e=0;k>e;e+=1)d=e%b,j[e]={paths:a[e].paths,x:l[d],y:Math.floor(e/b)*g,width:i[e]};return{width:h,height:f,g:j}}h().get("sprites.svg"),h().get("sprites.css");var k=c.defer(),l=a.getSelectedIcons();f.load("components/canvg/canvg.js",function(){k.resolve()}),a.download=function(){var c,f,m,n,o,p,q,r,s,t,u=a.imagePref.color||0,v=a.imagePref,w=[],x=a.normSize,y=v.height,z=[],A=g();if(!l.length)return e.show("Select a few icons first :)"),b.transitionTo("select"),void 0;for(u&&(u=u.toString(16),c=' fill="#'+u+'"'),f=0,o=l.length;o>f;f+=1){for(t=l[f],m=t.icon,m.tags&&(p=m.tags[0]),p=p||"untitled",q=p,n=2;-1!==w.indexOf(q);)q=p+n,n+=1;for(r=i(m.paths),r.viewBox={width:m.width||x,height:m.height||x},r.scale(y/(m.height||x)),s=r.getPathData(!0),n=0;n<s.length;n+=1)s[n]={d:s[n]},c&&(s[n].attrs=c);w.push(q),z[f]={width:r.viewBox.width,height:r.viewBox.height,paths:s}}k.promise.then(function(){return h().get("image.svg")}).then(function(a){var b,c,e,f=z.length,g=[];for((v.png||v.sprites)&&(b=document.createElement("canvas")),c=0;f>c;c+=1)g[c]=a.fill(z[c]),v.png&&(b.width=z[c].width,b.height=z[c].height,canvg(b,g[c]),A.add("PNG/"+w[c]+".png",b.toDataURL().replace(/.*,/m,""),{base64:!0})),A.add("SVG/"+w[c]+".svg",g[c]);p="IcoMoon-"+f+"-"+y+"px-"+"#"+d("zpad")(u,6)+".zip",v.sprites?(e=j(z,v.columns||1,v.margin),h().get("sprites.html").then(function(a){var b,c;for(b=0,c=z.length;c>b;b+=1)e.g[b].name=w[b],e.g[b].width=e.g[b].width?[{width:e.g[b].width}]:!1;return a=a.fill({color:u,icons:e.g}),A.add("sprites/sprites.html",a),h().get("sprites.css")}).then(function(a){return a=a.fill({icons:e.g,size:y}).replace(/-0px/g,"0"),A.add("sprites/sprites.css",a),h().get("sprites.svg")}).then(function(a){var c;c=a.fill(e),A.add("sprites/sprites.svg",c),b.width=e.width,b.height=e.height,canvg(b,c),A.add("sprites/sprites.png",b.toDataURL().replace(/.*,/m,""),{base64:!0}),A.save(p)})):A.save(p)})},a.close=function(){b.transitionTo("select")}}]),angular.module("icomoonApp").controller("ProjectsCtrl",["$scope","$state","session","cloud","message","fileSaver","icomoon",function(a,b,c,d,e,f,g){function h(a){var b=[],c=1;for(a=a||"Untitled Project",a+=" ",g.projects.forEach(function(a){b.push(a.metadata.name)});-1!==b.indexOf(a+c);)c+=1;return a+c}var i;!function(){var b,c,d=g.projects.slice(0);for(a.order=g.order||"Date Created",g.order=a.order,a.projects=[],b=0,c=d.length;c>b;b+=1)a.projects.push({idx:b,metadata:d[b].metadata})}(),a.isSyncing=c.isSyncing,d.auth().then(function(){a.signedIn=!0},function(){a.signedIn=!1}),d.hasCloudAccess().then(function(){a.cloudAccess=!0},function(){a.cloudAccess=!1}),a.$watch("order",function(b){var c;c="Date Modified"===b?function(a,b){return b.metadata.lastOpened-a.metadata.lastOpened}:"Date Created"===b?function(a,b){return a.metadata.created-b.metadata.created}:function(a,b){return a.metadata.name>b.metadata.name
},a.projects.sort(c)}),a.loadProject=function(a){g.currentProject=a,g.projects[a].metadata.lastOpened=(new Date).getTime(),b.transitionTo("select")},a.newProject=function(b){var c,d;b=b||{},c={name:h(),lastOpened:0,created:(new Date).getTime()},d={metadata:c,iconSets:b.iconSets||[]},b.preferences&&(d.preferences=b.preferences),g.projects.push(d),a.projects.push({idx:g.projects.length-1,metadata:c})},a.removeProject=function(b,c){var d=g.projects.length-2,f=function(){g.projects.splice(b,1),g.currentProject>d&&(g.currentProject=d),a.projects.splice(c,1),a.projects.forEach(function(a){a.idx>b&&(a.idx-=1)})};return g.projects[b].iconSets.length?(e.show({message:"Are you sure you want to remove this project?<br><strong>"+g.projects[b].metadata.name+"</strong>",firstButton:{caption:"Yes"},secondButton:{caption:"No",focused:!0}}).then(function(a){"Yes"===a&&f()}),void 0):(f(),void 0)},a.downloadProject=function(a){var b=g.projects[a];f().save(b.metadata.name+".json",JSON.stringify(b,null,"	"))},a.import=function(b){var c,d,f,i,j,k,l,m;if(b)for(j=b.length,j||e.show("Please select IcoMoon project files (JSON)."),c=0;j>c;c+=1){if(m=JSON.parse(b[c].file),d="icon-set"===m.IcoMoonType,f="selection"===m.IcoMoonType,f&&m.icons){for(l=[],i=0,k=m.icons.length;k>i;i+=1)l[i]=m.icons[i].properties,m.icons[i]=m.icons[i].icon;m.selection=l}if((d||f)&&m.icons)return delete m.IcoMoonType,a.newProject({iconSets:[m],preferences:m.projectPreferences||!1}),void 0;m.iconSets&&m.metadata?(m.metadata.name=h(m.metadata.name),g.projects.push(m),a.projects.push({metadata:m.metadata,idx:g.projects.length-1})):e.show("The selected project file was not valid.")}},a.$watch(function(){return a.order+JSON.stringify(a.projects)},function(){var b=[];clearTimeout(i),i=setTimeout(function(){g.order=a.order,c.save()},300),a.projects.forEach(function(a){a.metadata.name=a.metadata.name.trim(),b.push(a.metadata.name.replace(/\s*/g,""))}),a.projectNames=b}),a.reset=function(){c.reset().then(function(){location.reload()})}}]),angular.module("icomoonApp").controller("LibCtrl",["$scope","$http","$state","iconSets","cloud",function(a,b,c,d,e){var f=e.getPurchases().then(function(a){var b=[];return a.forEach(function(a){isNaN(a.product)||(b[a.product]=a.jsonlink)}),b});a.$watch(function(){return a.project.iconSets.slice(0)},function(b){var c,e,g,h,i,j=[];for(c=function(a,b){var c=a[b.productId];c&&(b.hasAccess=!0,b.json=c)},h=b.length,e=0;h>e;e+=1)i=b[e],b[e]=i.metadata.name,j[e]=a.getSetHash(i);for(e=0,h=d.length;h>e;e+=1)i=d[e],g=b.indexOf(i.name),i.button={},-1===g?(i.added=i.latest=!1,i.button.caption=i.button.caption2="Add",i.button.icon="plus"):(i.added={idx:g},i.latest=-1!==j.indexOf(i.iconsHash),i.latest?(i.button.caption="Remove",i.button.caption2="Removing",i.button.icon="minus"):(i.button.caption="Update",i.button.caption2="Updating",i.button.icon="sync")),i.purchaseLink?(i.hasAccess=!1,function(a){f.then(function(b){c(b,a)})}(i)):i.hasAccess=!0},!0),a.addremove=function(d){var e={transformResponse:!1};d.added&&d.latest&&a.removeSet(d.added.idx),d.latest||(d.button.disabled=!0,d.productId&&(e.withCredentials=!0),b.get(d.json,e).then(function(b){d.added&&a.removeSet(d.added.idx,!0),a.import([{file:b.data}]).always(function(){a.scrollPositions.select=0,c.transitionTo("select"),d.button.disabled=!1})}))},a.iconSets=d}]);